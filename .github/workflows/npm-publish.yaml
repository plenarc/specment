name: NPM Publish
# Ëá™ÂãïnpmÂÖ¨Èñã„ÉØ„Éº„ÇØ„Éï„É≠„Éº - „É°„Ç§„É≥„Éñ„É©„É≥„ÉÅ„Å∏„ÅÆ„Éó„É´„É™„ÇØ„Ç®„Çπ„Éà„Éû„Éº„Ç∏ÊôÇ„Å´ÂÆüË°å

on:
  push:
    branches:
      - main
  workflow_dispatch:

# „Çª„Ç≠„É•„É™„ÉÜ„Ç£: ÊúÄÂ∞èÊ®©Èôê„ÅÆÂéüÂâá„Å´Âü∫„Å•„ÅèÊ®©ÈôêË®≠ÂÆö
permissions:
  contents: write    # „É™„Éù„Ç∏„Éà„É™„Å∏„ÅÆÊõ∏„ÅçËæº„ÅøÔºà„Çø„Ç∞‰ΩúÊàê„ÄÅ„É™„É™„Éº„Çπ‰ΩúÊàêÁî®Ôºâ
  id-token: write    # OIDC „Éà„Éº„ÇØ„É≥Áô∫Ë°åÔºànpm provenanceÁî®Ôºâ
  actions: read      # „Ç¢„ÇØ„Ç∑„Éß„É≥ÂÆüË°åÁä∂Ê≥Å„ÅÆË™≠„ÅøÂèñ„Çä
  checks: read       # „ÉÅ„Çß„ÉÉ„ÇØÁµêÊûú„ÅÆË™≠„ÅøÂèñ„Çä

# ÂêåÊôÇÂÆüË°åÂà∂Âæ° - Âêå„Åò„ÉØ„Éº„ÇØ„Éï„É≠„Éº„ÅåÈáçË§áÂÆüË°å„Åï„Çå„Çã„Åì„Å®„ÇíÈò≤„Åê
concurrency: 
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true  # Êñ∞„Åó„ÅÑÂÆüË°åÊôÇ„Å´Âè§„ÅÑÂÆüË°å„Çí„Ç≠„É£„É≥„Çª„É´

# „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©Âåñ„ÅÆ„Åü„ÇÅ„ÅÆÁí∞Â¢ÉÂ§âÊï∞
env:
  # pnpmË®≠ÂÆö„ÅÆÊúÄÈÅ©Âåñ
  PNPM_CACHE_FOLDER: ~/.pnpm
  # Node.jsÊúÄÈÅ©Âåñ
  NODE_OPTIONS: --max-old-space-size=4096
  # CIÁí∞Â¢É„Åß„ÅÆÊúÄÈÅ©Âåñ
  CI: true
  FORCE_COLOR: 1

jobs:
  publish:
    name: Build, Test and Publish to NPM
    runs-on: windows-latest
    timeout-minutes: 30  # „ÉØ„Éº„ÇØ„Éï„É≠„ÉºÂÖ®‰Ωì„ÅÆ„Çø„Ç§„É†„Ç¢„Ç¶„ÉàÔºà30ÂàÜÔºâ
    # „Çª„Ç≠„É•„É™„ÉÜ„Ç£: WSLÁí∞Â¢É„Åß„ÅÆÂÆüË°åÔºàLinux„ÉÑ„Éº„É´„ÉÅ„Çß„Éº„É≥„ÅÆÂà©Áî®Ôºâ
    defaults:
      run:
        shell: wsl-bash {0}
    
    steps:
      - name: '[1/18] Setup WSL'
        uses: Vampire/setup-wsl@v3
        with:
          distribution: Ubuntu-22.04
          use-cache: false

      - name: '[2/18] Checkout repository'
        uses: actions/checkout@v4
        with:
          # ÂÖ®Â±•Ê≠¥„ÇíÂèñÂæóÔºàChangesets„Å®„Çø„Ç∞‰ΩúÊàê„Å´ÂøÖË¶ÅÔºâ
          fetch-depth: 0

      - name: '[3/18] Setup Node.js LTS in WSL'
        run: |
          # Node.js„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´ÔºàNodeSourceÁµåÁî±Ôºâ
          curl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -
          sudo apt-get install -y nodejs
          
          # npm„É¨„Ç∏„Çπ„Éà„É™„ÅÆË®≠ÂÆö
          npm config set registry https://registry.npmjs.org
          
          # „Éê„Éº„Ç∏„Éß„É≥Á¢∫Ë™ç
          echo "Node.js version: $(node --version)"
          echo "npm version: $(npm --version)"

      - name: '[4/18] Setup pnpm package manager in WSL'
        run: |
          # pnpm„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´
          npm install -g pnpm@latest
          
          # pnpm„ÅÆË®≠ÂÆö
          pnpm config set registry https://registry.npmjs.org
          
          # „Éê„Éº„Ç∏„Éß„É≥Á¢∫Ë™ç
          echo "pnpm version: $(pnpm --version)"

      - name: '[5/18] Get pnpm store directory'
        run: |
          STORE_PATH=$(pnpm store path --silent)
          echo "STORE_PATH=$STORE_PATH" >> $GITHUB_ENV
          echo "pnpm store path: $STORE_PATH"

      - name: '[6/18] Setup pnpm cache'
        uses: actions/cache@v4
        with:
          path: ${{ env.STORE_PATH }}
          key: ${{ runner.os }}-wsl-pnpm-store-${{ hashFiles('**/pnpm-lock.yaml') }}-${{ hashFiles('**/package.json') }}
          restore-keys: |
            ${{ runner.os }}-wsl-pnpm-store-${{ hashFiles('**/pnpm-lock.yaml') }}-
            ${{ runner.os }}-wsl-pnpm-store-
          save-always: true

      - name: '[6.5/18] Setup Node.js modules cache'
        uses: actions/cache@v4
        with:
          path: |
            ~/.npm
            ~/.cache/pnpm
            node_modules
            packages/*/node_modules
          key: ${{ runner.os }}-wsl-node-modules-${{ hashFiles('**/pnpm-lock.yaml') }}
          restore-keys: |
            ${{ runner.os }}-wsl-node-modules-

      - name: '[7/18] Install dependencies'
        id: install-deps
        timeout-minutes: 10  # ‰æùÂ≠òÈñ¢‰øÇ„Ç§„É≥„Çπ„Éà„Éº„É´„ÅÆ„Çø„Ç§„É†„Ç¢„Ç¶„Éà
        run: |
          echo "üì¶ Installing project dependencies..."
          echo "‚è∞ Started at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
          echo ""
          
          # ‰∫ãÂâç„ÉÅ„Çß„ÉÉ„ÇØ
          echo "üîç Pre-installation checks:"
          echo "  ‚Ä¢ pnpm version: $(pnpm --version)"
          echo "  ‚Ä¢ Node.js version: $(node --version)"
          echo "  ‚Ä¢ npm registry: $(pnpm config get registry)"
          echo "  ‚Ä¢ Working directory: $(pwd)"
          echo "  ‚Ä¢ Available disk space: $(df -h . | tail -1 | awk '{print $4}')"
          echo ""
          
          # pnpm-lock.yaml „ÅÆÂ≠òÂú®Á¢∫Ë™ç
          if [ ! -f "pnpm-lock.yaml" ]; then
            echo "‚ö†Ô∏è Warning: pnpm-lock.yaml not found"
            echo "This may indicate:"
            echo "  - First-time setup (will generate lockfile)"
            echo "  - Missing lockfile in repository"
            echo "  - Incorrect working directory"
            echo ""
          else
            echo "‚úÖ pnpm-lock.yaml found"
            echo "  ‚Ä¢ File size: $(ls -lh pnpm-lock.yaml | awk '{print $5}')"
            echo "  ‚Ä¢ Last modified: $(ls -l pnpm-lock.yaml | awk '{print $6, $7, $8}')"
          fi
          echo ""
          
          # package.json „ÅÆÊ§úË®º
          echo "üîç Validating package.json files:"
          if [ -f "package.json" ]; then
            echo "  ‚úÖ Root package.json found"
            if jq empty package.json 2>/dev/null; then
              echo "    ‚Ä¢ JSON syntax: Valid"
              echo "    ‚Ä¢ Package name: $(jq -r '.name // "N/A"' package.json)"
              echo "    ‚Ä¢ Dependencies: $(jq -r '.dependencies | length // 0' package.json) packages"
              echo "    ‚Ä¢ DevDependencies: $(jq -r '.devDependencies | length // 0' package.json) packages"
            else
              echo "    ‚ùå JSON syntax: Invalid"
              echo "    This will cause installation to fail"
              exit 1
            fi
          else
            echo "  ‚ùå Root package.json not found"
            exit 1
          fi
          
          # Workspace packages „ÅÆÁ¢∫Ë™ç
          if [ -d "packages" ]; then
            echo "  üìÅ Workspace packages:"
            find packages -name "package.json" -type f | while read -r pkg; do
              if jq empty "$pkg" 2>/dev/null; then
                PKG_NAME=$(jq -r '.name // "unnamed"' "$pkg")
                echo "    ‚úÖ $pkg ($PKG_NAME)"
              else
                echo "    ‚ùå $pkg (Invalid JSON)"
                exit 1
              fi
            done
          fi
          echo ""
          
          # „Ç≠„É£„ÉÉ„Ç∑„É•„Éí„ÉÉ„ÉàÁ¢∫Ë™ç
          if [ -d "node_modules" ] && [ -f "node_modules/.pnpm/lock.yaml" ]; then
            echo "üì¶ Cache hit detected - verifying integrity..."
            if pnpm install --frozen-lockfile --prefer-offline --offline 2>/dev/null; then
              echo "‚úÖ Dependencies restored from cache successfully"
              echo "‚ö° Skipping full installation due to cache hit"
              exit 0
            else
              echo "‚ö†Ô∏è Cache integrity check failed - proceeding with full installation"
            fi
          fi

          # ‰æùÂ≠òÈñ¢‰øÇ„Ç§„É≥„Çπ„Éà„Éº„É´„ÅÆÂÆüË°å
          echo "üöÄ Starting dependency installation..."
          echo "Command: pnpm install --frozen-lockfile --prefer-offline"
          echo ""
          
          # „Ç§„É≥„Çπ„Éà„Éº„É´ÈñãÂßãÊôÇÂàª„ÇíË®òÈå≤
          INSTALL_START=$(date +%s)
          
          if pnpm install --frozen-lockfile --prefer-offline; then
            INSTALL_END=$(date +%s)
            INSTALL_DURATION=$((INSTALL_END - INSTALL_START))
            
            echo ""
            echo "‚úÖ Dependencies installed successfully"
            echo "‚è±Ô∏è Installation completed in ${INSTALL_DURATION} seconds"
            echo "‚è∞ Finished at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
            echo ""
            
            # „Ç§„É≥„Çπ„Éà„Éº„É´Âæå„ÅÆÊ§úË®º
            echo "üîç Post-installation verification:"
            echo "  ‚Ä¢ node_modules size: $(du -sh node_modules 2>/dev/null | cut -f1 || echo 'N/A')"
            echo "  ‚Ä¢ Installed packages: $(find node_modules -maxdepth 1 -type d | wc -l) directories"
            
            # ÈáçË¶Å„Å™„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅÆÂ≠òÂú®Á¢∫Ë™ç
            echo "  ‚Ä¢ Critical packages:"
            for pkg in typescript @changesets/cli vitest; do
              if [ -d "node_modules/$pkg" ]; then
                echo "    ‚úÖ $pkg"
              else
                echo "    ‚ö†Ô∏è $pkg (not found)"
              fi
            done
            echo ""
            
          else
            INSTALL_END=$(date +%s)
            INSTALL_DURATION=$((INSTALL_END - INSTALL_START))
            
            echo ""
            echo "‚ùå Dependency installation failed"
            echo "‚è±Ô∏è Failed after ${INSTALL_DURATION} seconds"
            echo "‚è∞ Failed at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
            echo ""
            
            # Â§±ÊïóÊôÇ„ÅÆË©≥Á¥∞Ë®∫Êñ≠
            echo "üîç Failure diagnosis:"
            
            # „Éá„Ç£„Çπ„ÇØÂÆπÈáè„ÉÅ„Çß„ÉÉ„ÇØ
            echo "  ‚Ä¢ Disk space:"
            df -h . | tail -1 | awk '{print "    Available: " $4 ", Used: " $3 " (" $5 ")"}'
            
            # „Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÊé•Á∂ö„ÉÅ„Çß„ÉÉ„ÇØ
            echo "  ‚Ä¢ Network connectivity:"
            if curl -s --max-time 5 https://registry.npmjs.org/ > /dev/null; then
              echo "    ‚úÖ npm registry accessible"
            else
              echo "    ‚ùå npm registry not accessible"
            fi
            
            # pnpmË®≠ÂÆö„ÉÅ„Çß„ÉÉ„ÇØ
            echo "  ‚Ä¢ pnpm configuration:"
            echo "    Registry: $(pnpm config get registry)"
            echo "    Store path: $(pnpm store path 2>/dev/null || echo 'N/A')"
            echo "    Cache path: $(pnpm config get cache-dir 2>/dev/null || echo 'N/A')"
            
            # lockfileÊï¥ÂêàÊÄß„ÉÅ„Çß„ÉÉ„ÇØ
            if [ -f "pnpm-lock.yaml" ]; then
              echo "  ‚Ä¢ Lockfile integrity:"
              if pnpm install --frozen-lockfile --dry-run > /dev/null 2>&1; then
                echo "    ‚úÖ Lockfile is consistent with package.json"
              else
                echo "    ‚ùå Lockfile inconsistent with package.json"
                echo "    Suggestion: Delete pnpm-lock.yaml and regenerate"
              fi
            fi
            
            # Ê®©Èôê„ÉÅ„Çß„ÉÉ„ÇØ
            echo "  ‚Ä¢ File permissions:"
            if [ -w "." ]; then
              echo "    ‚úÖ Write permission to current directory"
            else
              echo "    ‚ùå No write permission to current directory"
            fi
            
            echo ""
            echo "üîß Suggested troubleshooting steps:"
            echo "  1. Check network connectivity to npm registry"
            echo "  2. Verify pnpm-lock.yaml is up to date"
            echo "  3. Ensure sufficient disk space is available"
            echo "  4. Check for package.json syntax errors"
            echo "  5. Try clearing pnpm cache: pnpm store prune"
            echo "  6. Regenerate lockfile if necessary"
            echo ""
            echo "üìö For detailed troubleshooting, see the error handling section"
            
            exit 1
          fi

      - name: '[8/18] Build project'
        id: build-project
        timeout-minutes: 5  # „Éì„É´„Éâ„Éó„É≠„Çª„Çπ„ÅÆ„Çø„Ç§„É†„Ç¢„Ç¶„Éà
        run: |
          echo "üî® Building project..."
          echo "‚è∞ Started at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
          echo ""
          
          # „Éì„É´„ÉâÂâç„ÉÅ„Çß„ÉÉ„ÇØ
          echo "üîç Pre-build checks:"
          echo "  ‚Ä¢ TypeScript version: $(npx tsc --version 2>/dev/null || echo 'Not available')"
          echo "  ‚Ä¢ Build script: $(jq -r '.scripts["specment:build"] // "Not defined"' package.json)"
          echo "  ‚Ä¢ Working directory: $(pwd)"
          echo ""
          
          # TypeScriptË®≠ÂÆö„ÅÆÊ§úË®º
          echo "üîç TypeScript configuration validation:"
          if [ -f "tsconfig.json" ]; then
            echo "  ‚úÖ tsconfig.json found"
            if jq empty tsconfig.json 2>/dev/null; then
              echo "    ‚Ä¢ JSON syntax: Valid"
              echo "    ‚Ä¢ Compiler target: $(jq -r '.compilerOptions.target // "Not specified"' tsconfig.json)"
              echo "    ‚Ä¢ Module system: $(jq -r '.compilerOptions.module // "Not specified"' tsconfig.json)"
              echo "    ‚Ä¢ Output directory: $(jq -r '.compilerOptions.outDir // "Not specified"' tsconfig.json)"
            else
              echo "    ‚ùå JSON syntax: Invalid"
              echo "    This will cause build to fail"
              exit 1
            fi
          else
            echo "  ‚ö†Ô∏è tsconfig.json not found in root"
          fi
          
          # Workspace TypeScriptË®≠ÂÆö„ÅÆÁ¢∫Ë™ç
          if [ -f "packages/specment/tsconfig.json" ]; then
            echo "  ‚úÖ packages/specment/tsconfig.json found"
            if ! jq empty packages/specment/tsconfig.json 2>/dev/null; then
              echo "    ‚ùå Invalid JSON syntax in package tsconfig"
              exit 1
            fi
          fi
          echo ""
          
          # „ÇΩ„Éº„Çπ„Éï„Ç°„Ç§„É´„ÅÆÂ≠òÂú®Á¢∫Ë™ç
          echo "üîç Source files verification:"
          if [ -d "packages/specment/src" ]; then
            SRC_FILES=$(find packages/specment/src -name "*.ts" -o -name "*.tsx" | wc -l)
            echo "  ‚úÖ Source directory found"
            echo "    ‚Ä¢ TypeScript files: $SRC_FILES"
            echo "    ‚Ä¢ Main entry: $(ls packages/specment/src/index.ts 2>/dev/null && echo "Found" || echo "Not found")"
          else
            echo "  ‚ùå Source directory not found"
            echo "  Expected: packages/specment/src"
            exit 1
          fi
          echo ""
          
          # Êó¢Â≠ò„ÅÆ„Éì„É´„ÉâÂá∫Âäõ„Çí„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
          echo "üßπ Cleaning previous build outputs..."
          if [ -d "packages/specment/dist" ]; then
            rm -rf packages/specment/dist
            echo "  ‚úÖ Removed existing dist directory"
          fi
          if [ -f "packages/specment/.tsbuildinfo" ]; then
            rm -f packages/specment/.tsbuildinfo
            echo "  ‚úÖ Removed TypeScript build info"
          fi
          echo ""
          
          # „Éì„É´„ÉâÂÆüË°å
          echo "üöÄ Starting build process..."
          echo "Command: pnpm specment:build"
          echo ""
          
          BUILD_START=$(date +%s)
          
          # „Éì„É´„Éâ„É≠„Ç∞„ÇíË©≥Á¥∞„Å´Ë®òÈå≤
          if pnpm specment:build 2>&1 | tee build.log; then
            BUILD_END=$(date +%s)
            BUILD_DURATION=$((BUILD_END - BUILD_START))
            
            echo ""
            echo "‚úÖ Project built successfully"
            echo "‚è±Ô∏è Build completed in ${BUILD_DURATION} seconds"
            echo "‚è∞ Finished at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
            echo ""
            
            # „Éì„É´„ÉâÂæå„ÅÆÊ§úË®º
            echo "üîç Post-build verification:"
            if [ -d "packages/specment/dist" ]; then
              DIST_FILES=$(find packages/specment/dist -type f | wc -l)
              DIST_SIZE=$(du -sh packages/specment/dist | cut -f1)
              echo "  ‚úÖ Build output generated"
              echo "    ‚Ä¢ Output directory: packages/specment/dist"
              echo "    ‚Ä¢ Generated files: $DIST_FILES"
              echo "    ‚Ä¢ Total size: $DIST_SIZE"
              
              # ÈáçË¶Å„Å™„Éï„Ç°„Ç§„É´„ÅÆÂ≠òÂú®Á¢∫Ë™ç
              echo "  ‚Ä¢ Key output files:"
              for file in index.js index.d.ts package.json; do
                if [ -f "packages/specment/dist/$file" ]; then
                  echo "    ‚úÖ $file"
                else
                  echo "    ‚ö†Ô∏è $file (not found)"
                fi
              done
              
              # TypeScriptÂÆ£Ë®Ä„Éï„Ç°„Ç§„É´„ÅÆÁ¢∫Ë™ç
              DECLARATION_FILES=$(find packages/specment/dist -name "*.d.ts" | wc -l)
              echo "    ‚Ä¢ Declaration files: $DECLARATION_FILES"
              
            else
              echo "  ‚ö†Ô∏è No build output directory found"
              echo "  This may indicate a build configuration issue"
            fi
            
            # „Éì„É´„Éâ„É≠„Ç∞„ÅÆ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
            rm -f build.log
            
          else
            BUILD_END=$(date +%s)
            BUILD_DURATION=$((BUILD_END - BUILD_START))
            
            echo ""
            echo "‚ùå Build process failed"
            echo "‚è±Ô∏è Failed after ${BUILD_DURATION} seconds"
            echo "‚è∞ Failed at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
            echo ""
            
            # Â§±ÊïóÊôÇ„ÅÆË©≥Á¥∞Ë®∫Êñ≠
            echo "üîç Build failure diagnosis:"
            
            # TypeScript „Ç≥„É≥„Éë„Ç§„É©„Éº„Ç®„É©„Éº„ÅÆÂàÜÊûê
            if [ -f "build.log" ]; then
              echo "  ‚Ä¢ Error analysis from build log:"
              
              # „Ç®„É©„Éº„ÅÆÁ®ÆÈ°û„ÇíÂàÜÈ°û
              if grep -q "error TS" build.log; then
                echo "    ‚ùå TypeScript compilation errors detected"
                echo "    Top errors:"
                grep "error TS" build.log | head -5 | sed 's/^/      /'
              fi
              
              if grep -q "Cannot find module" build.log; then
                echo "    ‚ùå Module resolution errors detected"
                echo "    Missing modules:"
                grep "Cannot find module" build.log | head -3 | sed 's/^/      /'
              fi
              
              if grep -q "Syntax error" build.log; then
                echo "    ‚ùå Syntax errors detected"
                echo "    Syntax issues:"
                grep "Syntax error" build.log | head -3 | sed 's/^/      /'
              fi
              
              # „Éì„É´„Éâ„É≠„Ç∞„ÅÆ‰øùÂ≠òÔºà„Éá„Éê„ÉÉ„Ç∞Áî®Ôºâ
              echo ""
              echo "  üìÑ Full build log (last 20 lines):"
              tail -20 build.log | sed 's/^/    /'
              
            else
              echo "    ‚ö†Ô∏è No build log available for analysis"
            fi
            
            # Ë®≠ÂÆö„Éï„Ç°„Ç§„É´„ÅÆÊ§úË®º
            echo ""
            echo "  ‚Ä¢ Configuration verification:"
            
            # tsconfig.json „ÅÆË©≥Á¥∞„ÉÅ„Çß„ÉÉ„ÇØ
            if [ -f "packages/specment/tsconfig.json" ]; then
              echo "    ‚Ä¢ Checking TypeScript configuration..."
              if npx tsc --noEmit --project packages/specment/tsconfig.json 2>&1 | head -10; then
                echo "      Configuration appears valid"
              else
                echo "      Configuration may have issues"
              fi
            fi
            
            # ‰æùÂ≠òÈñ¢‰øÇ„ÅÆÁ¢∫Ë™ç
            echo "    ‚Ä¢ Build dependencies:"
            for dep in typescript @types/node; do
              if [ -d "node_modules/$dep" ]; then
                VERSION=$(jq -r '.version' "node_modules/$dep/package.json" 2>/dev/null || echo "unknown")
                echo "      ‚úÖ $dep ($VERSION)"
              else
                echo "      ‚ùå $dep (missing)"
              fi
            done
            
            echo ""
            echo "üîß Suggested troubleshooting steps:"
            echo "  1. Review TypeScript compilation errors above"
            echo "  2. Check tsconfig.json configuration"
            echo "  3. Verify all imports and module paths"
            echo "  4. Ensure all dependencies are installed"
            echo "  5. Run 'pnpm specment:build' locally to reproduce"
            echo "  6. Check for syntax errors in source files"
            echo "  7. Validate TypeScript version compatibility"
            echo ""
            echo "üìö For detailed troubleshooting, see the error handling section"
            
            # „Éì„É´„Éâ„É≠„Ç∞„Çí‰øùÊåÅÔºà„Éá„Éê„ÉÉ„Ç∞Áî®Ôºâ
            if [ -f "build.log" ]; then
              echo "üíæ Build log preserved for debugging"
            fi
            
            exit 1
          fi

      # ‰∏¶ÂàóÂÆüË°åÂèØËÉΩ„Å™„Çπ„ÉÜ„ÉÉ„Éó„Çí„Ç∏„Éß„Éñ„É¨„Éô„É´„ÅßÂàÜÈõ¢
      - name: '[9/18] Run quality checks (parallel)'
        id: quality-checks
        run: |
          echo "üîÑ Running quality checks in parallel..."
          
          # „Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„Éâ„Åß„É™„É≥„ÉÜ„Ç£„É≥„Ç∞„ÇíÂÆüË°å
          echo "üßπ Starting linting checks..."
          (
            if pnpm lint 2>&1 | tee lint.log; then
              echo "‚úÖ Linting passed" > lint.result
            else
              echo "‚ùå Linting failed" > lint.result
              exit 1
            fi
          ) &
          LINT_PID=$!
          
          # „Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„Éâ„Åß„Çª„Ç≠„É•„É™„ÉÜ„Ç£„ÉÅ„Çß„ÉÉ„ÇØ„ÇíÂÆüË°å
          echo "üîê Starting security validation..."
          (
            echo "üìã Basic security checks:"
            
            # NPM_TOKENÂ≠òÂú®Á¢∫Ë™çÔºàÂÄ§„ÅØË°®Á§∫„Åó„Å™„ÅÑÔºâ
            if [ -n "${{ secrets.NPM_TOKEN }}" ]; then
              echo "  ‚úÖ NPM_TOKEN is configured"
            else
              echo "  ‚ùå NPM_TOKEN is not configured"
              echo "‚ùå Security check failed" > security.result
              exit 1
            fi
            
            # GITHUB_TOKENÂ≠òÂú®Á¢∫Ë™ç
            if [ -n "${{ secrets.GITHUB_TOKEN }}" ]; then
              echo "  ‚úÖ GITHUB_TOKEN is available"
            else
              echo "  ‚ùå GITHUB_TOKEN is not available"
              echo "‚ùå Security check failed" > security.result
              exit 1
            fi
            
            echo "  ‚úÖ Workflow permissions: Minimal required permissions set"
            echo "  ‚úÖ npm provenance: Will be enabled during publication"
            echo "  ‚úÖ Log security: Sensitive information masking implemented"
            echo "‚úÖ Security validation passed" > security.result
          ) &
          SECURITY_PID=$!
          
          # ‰∏°Êñπ„ÅÆÂá¶ÁêÜ„ÅÆÂÆå‰∫Ü„ÇíÂæÖÊ©ü
          echo "‚è≥ Waiting for parallel checks to complete..."
          
          wait $LINT_PID
          LINT_EXIT=$?
          
          wait $SECURITY_PID
          SECURITY_EXIT=$?
          
          # ÁµêÊûú„ÅÆÁ¢∫Ë™ç
          if [ $LINT_EXIT -eq 0 ] && [ $SECURITY_EXIT -eq 0 ]; then
            echo "‚úÖ All quality checks passed"
            cat lint.result 2>/dev/null || echo "‚úÖ Linting completed"
            cat security.result 2>/dev/null || echo "‚úÖ Security validation completed"
          else
            echo "‚ùå Quality checks failed"
            if [ $LINT_EXIT -ne 0 ]; then
              echo "‚ùå Linting failed - check lint.log for details"
              cat lint.result 2>/dev/null
              echo "Run 'pnpm lint:fix' locally to auto-fix issues"
            fi
            if [ $SECURITY_EXIT -ne 0 ]; then
              echo "‚ùå Security validation failed"
              cat security.result 2>/dev/null
            fi
            exit 1
          fi
          
          # „ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
          rm -f lint.log lint.result security.result

      - name: '[10/18] Run tests'
        id: run-tests
        timeout-minutes: 10  # „ÉÜ„Çπ„ÉàÂÆüË°å„ÅÆ„Çø„Ç§„É†„Ç¢„Ç¶„Éà
        run: |
          echo "üß™ Running test suite..."
          echo "‚è∞ Started at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
          
          # „ÉÜ„Çπ„ÉàÂÆüË°åÂâç„ÅÆÁí∞Â¢ÉÁ¢∫Ë™ç
          echo "üîç Test environment verification:"
          echo "  ‚Ä¢ Node.js version: $(node --version)"
          echo "  ‚Ä¢ Test runner: vitest"
          echo "  ‚Ä¢ Test command: pnpm --filter @plenarc/specment test --run"
          echo ""
          
          TEST_START=$(date +%s)
          
          if pnpm --filter @plenarc/specment test --run 2>&1 | tee test.log; then
            TEST_END=$(date +%s)
            TEST_DURATION=$((TEST_END - TEST_START))
            
            echo ""
            echo "‚úÖ All tests passed"
            echo "‚è±Ô∏è Tests completed in ${TEST_DURATION} seconds"
            echo "‚è∞ Finished at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
            
            # „ÉÜ„Çπ„ÉàÁµêÊûú„ÅÆË¶ÅÁ¥Ñ
            if grep -q "Test Files" test.log; then
              echo ""
              echo "üìä Test Summary:"
              grep -E "(Test Files|Tests|Expect|Duration)" test.log | sed 's/^/  /'
            fi
            
          else
            TEST_END=$(date +%s)
            TEST_DURATION=$((TEST_END - TEST_START))
            
            echo ""
            echo "‚ùå Tests failed"
            echo "‚è±Ô∏è Failed after ${TEST_DURATION} seconds"
            echo "‚è∞ Failed at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
            echo ""
            echo "üîç Test failure analysis:"
            if grep -q "FAIL" test.log; then
              echo "  Failed tests:"
              grep "FAIL" test.log | head -5 | sed 's/^/    /'
            fi
            echo ""
            echo "üîß To reproduce locally:"
            echo "  pnpm --filter @plenarc/specment test"
            echo ""
            echo "üìÑ Full test log available in workflow artifacts"
            exit 1
          fi
          
          # „ÉÜ„Çπ„Éà„É≠„Ç∞„ÅÆ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
          rm -f test.log

      - name: '[11/18] Early changeset validation'
        id: early-changeset-check
        if: success()
        run: |
          echo "üîç Early changeset validation for workflow optimization..."
          
          # Âü∫Êú¨ÁöÑ„Å™ChangesetsÂ≠òÂú®Á¢∫Ë™ç„ÅÆ„ÅøÂÆüË°å
          if [ ! -d ".changeset" ]; then
            echo "‚è≠Ô∏è No .changeset directory found - workflow will skip publication steps"
            echo "early-skip=true" >> $GITHUB_OUTPUT
            echo "skip-reason=no-changeset-directory" >> $GITHUB_OUTPUT
            exit 0
          fi
          
          # Changeset„Éï„Ç°„Ç§„É´„ÅÆÁ∞°ÊòìÁ¢∫Ë™ç
          CHANGESET_FILES=$(find .changeset -name "*.md" -not -name "README.md" 2>/dev/null | wc -l)
          
          if [ "$CHANGESET_FILES" -eq 0 ]; then
            echo "‚è≠Ô∏è No changeset files found - workflow will skip publication steps"
            echo "early-skip=true" >> $GITHUB_OUTPUT
            echo "skip-reason=no-changeset-files" >> $GITHUB_OUTPUT
            echo ""
            echo "üí° To publish a new version:"
            echo "  1. Run 'pnpm changeset' to create a changeset"
            echo "  2. Commit and push the changeset file"
            echo "  3. Merge to main branch to trigger publication"
            exit 0
          fi
          
          echo "‚úÖ Changesets detected ($CHANGESET_FILES files) - continuing with full workflow"
          echo "early-skip=false" >> $GITHUB_OUTPUT
          echo "skip-reason=" >> $GITHUB_OUTPUT
          echo "üîê Performing security validation..."
          
          # „Çª„Ç≠„É•„É™„ÉÜ„Ç£Ë®≠ÂÆö„ÅÆÂü∫Êú¨Á¢∫Ë™ç
          echo "üìã Basic security checks:"
          
          # NPM_TOKENÂ≠òÂú®Á¢∫Ë™çÔºàÂÄ§„ÅØË°®Á§∫„Åó„Å™„ÅÑÔºâ
          if [ -n "${{ secrets.NPM_TOKEN }}" ]; then
            echo "  ‚úÖ NPM_TOKEN is configured"
          else
            echo "  ‚ùå NPM_TOKEN is not configured"
            exit 1
          fi
          
          # GITHUB_TOKENÂ≠òÂú®Á¢∫Ë™ç
          if [ -n "${{ secrets.GITHUB_TOKEN }}" ]; then
            echo "  ‚úÖ GITHUB_TOKEN is available"
          else
            echo "  ‚ùå GITHUB_TOKEN is not available"
            exit 1
          fi
          
          # „ÉØ„Éº„ÇØ„Éï„É≠„ÉºÊ®©Èôê„ÅÆÁ¢∫Ë™ç
          echo "  ‚úÖ Workflow permissions: Minimal required permissions set"
          echo "  ‚úÖ npm provenance: Will be enabled during publication"
          echo "  ‚úÖ Log security: Sensitive information masking implemented"
          
          echo "üîê Security validation completed successfully"

      - name: '[12/18] Detailed changeset validation'
        id: changesets-check
        if: success() && steps.early-changeset-check.outputs.early-skip == 'false'
        run: |
          echo "üîç Checking for changesets and validating configuration..."
          
          # ChangesetsË®≠ÂÆö„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅÆÂ≠òÂú®Á¢∫Ë™ç
          if [ ! -d ".changeset" ]; then
            echo "‚ùå .changeset directory not found"
            echo "changesets-exist=false" >> $GITHUB_OUTPUT
            echo "validation-error=missing-directory" >> $GITHUB_OUTPUT
            echo ""
            echo "üîß To fix this issue:"
            echo "  1. Run 'pnpm changeset init' to initialize changesets"
            echo "  2. Commit the .changeset directory"
            echo "  3. Create a changeset with 'pnpm changeset'"
            exit 0
          fi
          
          # ChangesetsË®≠ÂÆö„Éï„Ç°„Ç§„É´„ÅÆÂ≠òÂú®„Å®Â¶•ÂΩìÊÄßÁ¢∫Ë™ç
          if [ ! -f ".changeset/config.json" ]; then
            echo "‚ùå .changeset/config.json not found"
            echo "changesets-exist=false" >> $GITHUB_OUTPUT
            echo "validation-error=missing-config" >> $GITHUB_OUTPUT
            echo ""
            echo "üîß To fix this issue:"
            echo "  1. Run 'pnpm changeset init' to create config.json"
            echo "  2. Configure the settings according to your project needs"
            exit 0
          fi
          
          # Ë®≠ÂÆö„Éï„Ç°„Ç§„É´„ÅÆJSONÂ¶•ÂΩìÊÄßÁ¢∫Ë™ç
          if ! jq empty .changeset/config.json 2>/dev/null; then
            echo "‚ùå .changeset/config.json contains invalid JSON"
            echo "changesets-exist=false" >> $GITHUB_OUTPUT
            echo "validation-error=invalid-config-json" >> $GITHUB_OUTPUT
            echo ""
            echo "üîß To fix this issue:"
            echo "  1. Check the JSON syntax in .changeset/config.json"
            echo "  2. Use a JSON validator to identify syntax errors"
            echo "  3. Fix the JSON formatting and commit the changes"
            exit 0
          fi
          
          # Ë®≠ÂÆö„Éï„Ç°„Ç§„É´„ÅÆÂøÖÈ†à„Éï„Ç£„Éº„É´„ÉâÁ¢∫Ë™ç
          echo "üìã Validating changeset configuration..."
          
          # baseBranchË®≠ÂÆö„ÅÆÁ¢∫Ë™ç
          BASE_BRANCH=$(jq -r '.baseBranch // "main"' .changeset/config.json)
          if [ "$BASE_BRANCH" != "main" ] && [ "$BASE_BRANCH" != "master" ]; then
            echo "‚ö†Ô∏è Warning: baseBranch is set to '$BASE_BRANCH' (expected 'main' or 'master')"
          fi
          echo "  ‚úì baseBranch: $BASE_BRANCH"
          
          # accessË®≠ÂÆö„ÅÆÁ¢∫Ë™ç
          ACCESS=$(jq -r '.access // "restricted"' .changeset/config.json)
          echo "  ‚úì access: $ACCESS"
          
          # changelogË®≠ÂÆö„ÅÆÁ¢∫Ë™ç
          CHANGELOG=$(jq -r '.changelog // "@changesets/cli/changelog"' .changeset/config.json)
          echo "  ‚úì changelog: $CHANGELOG"
          
          echo "‚úÖ Changeset configuration is valid"
          
          # Changeset„Éï„Ç°„Ç§„É´„ÅÆÂ≠òÂú®Á¢∫Ë™çÔºàREADME.md„ÇíÈô§Â§ñÔºâ
          CHANGESET_FILES=$(find .changeset -name "*.md" -not -name "README.md" 2>/dev/null | wc -l)
          
          if [ "$CHANGESET_FILES" -gt 0 ]; then
            echo "changesets-exist=true" >> $GITHUB_OUTPUT
            echo "validation-error=" >> $GITHUB_OUTPUT
            echo ""
            echo "‚úÖ Found $CHANGESET_FILES changeset file(s) - proceeding with release"
            echo ""
            echo "üìÑ Changeset files:"
            find .changeset -name "*.md" -not -name "README.md" 2>/dev/null | while read -r file; do
              echo "  - $(basename "$file")"
              echo "    Summary: $(head -n 10 "$file" | grep -E '^[^-]' | head -n 1 | sed 's/^[[:space:]]*//' || echo 'No summary available')"
            done
            
            # Changeset„Éï„Ç°„Ç§„É´„ÅÆÂ¶•ÂΩìÊÄßÁ¢∫Ë™ç
            echo ""
            echo "üîç Validating changeset files..."
            INVALID_FILES=0
            find .changeset -name "*.md" -not -name "README.md" 2>/dev/null | while read -r file; do
              if [ ! -s "$file" ]; then
                echo "  ‚ùå Empty changeset file: $(basename "$file")"
                INVALID_FILES=$((INVALID_FILES + 1))
              elif ! grep -q "^---" "$file"; then
                echo "  ‚ùå Invalid changeset format (missing frontmatter): $(basename "$file")"
                INVALID_FILES=$((INVALID_FILES + 1))
              else
                echo "  ‚úì Valid changeset: $(basename "$file")"
              fi
            done
            
            if [ "$INVALID_FILES" -gt 0 ]; then
              echo ""
              echo "‚ùå Found $INVALID_FILES invalid changeset file(s)"
              echo "changesets-exist=false" >> $GITHUB_OUTPUT
              echo "validation-error=invalid-changeset-files" >> $GITHUB_OUTPUT
              echo ""
              echo "üîß To fix this issue:"
              echo "  1. Check the changeset files listed above"
              echo "  2. Ensure each file has proper frontmatter (starts with ---)"
              echo "  3. Ensure files are not empty"
              echo "  4. Run 'pnpm changeset' to create properly formatted changesets"
              exit 0
            fi
            
          else
            echo "changesets-exist=false" >> $GITHUB_OUTPUT
            echo "validation-error=" >> $GITHUB_OUTPUT
            echo ""
            echo "‚è≠Ô∏è No changeset files found - skipping release"
            echo ""
            echo "üìù To publish a new version:"
            echo "  1. Run 'pnpm changeset' to create a changeset"
            echo "  2. Describe your changes and select the appropriate version bump"
            echo "  3. Commit and push the changeset file"
            echo "  4. Merge to main branch to trigger automatic publication"
            echo ""
            echo "üí° Changeset files should be created in the .changeset directory"
            echo "   and follow the format: YYYYMMDD-HHMMSS-description.md"
          fi

      - name: '[13/18] Setup npm authentication'
        if: success() && steps.early-changeset-check.outputs.early-skip == 'false' && steps.changesets-check.outputs.changesets-exist == 'true' && steps.changesets-check.outputs.validation-error == ''
        id: npm-auth
        run: |
          echo "üîê Setting up npm authentication..."
          
          # NPM_TOKEN„ÅÆÂ≠òÂú®Á¢∫Ë™ç
          if [ -z "${{ secrets.NPM_TOKEN }}" ]; then
            echo "‚ùå NPM_TOKEN is not set in GitHub Secrets"
            echo "npm-auth-success=false" >> $GITHUB_OUTPUT
            echo "auth-error=missing-token" >> $GITHUB_OUTPUT
            echo ""
            echo "üîß To fix this issue:"
            echo "  1. Go to GitHub repository Settings > Secrets and variables > Actions"
            echo "  2. Add NPM_TOKEN secret with your npm authentication token"
            echo "  3. Ensure the token has publish permissions for your packages"
            echo "  4. Re-run the workflow"
            exit 1
          fi
          
          # .npmrc„Éï„Ç°„Ç§„É´„ÅÆ‰ΩúÊàêÔºà„Çª„Ç≠„É•„Ç¢„Å™ÊñπÊ≥ïÔºâ
          echo "//registry.npmjs.org/:_authToken=\${NPM_TOKEN}" > ~/.npmrc
          echo "registry=https://registry.npmjs.org/" >> ~/.npmrc
          echo "access=public" >> ~/.npmrc
          
          # Ë™çË®ºË®≠ÂÆö„ÅÆÊ§úË®ºÔºà„Éà„Éº„ÇØ„É≥„ÅÆÂÄ§„ÅØË°®Á§∫„Åó„Å™„ÅÑÔºâ
          echo "üìã Verifying npm authentication configuration..."
          
          # .npmrc„Éï„Ç°„Ç§„É´„ÅÆÂ≠òÂú®Á¢∫Ë™ç
          if [ ! -f ~/.npmrc ]; then
            echo "‚ùå Failed to create .npmrc file"
            echo "npm-auth-success=false" >> $GITHUB_OUTPUT
            echo "auth-error=npmrc-creation-failed" >> $GITHUB_OUTPUT
            exit 1
          fi
          
          # Ë®≠ÂÆöÂÜÖÂÆπ„ÅÆÁ¢∫Ë™çÔºà„Éà„Éº„ÇØ„É≥ÂÄ§„ÅØÈô§Â§ñÔºâ
          echo "  ‚úì .npmrc file created successfully"
          echo "  ‚úì Registry: $(grep '^registry=' ~/.npmrc | cut -d'=' -f2)"
          echo "  ‚úì Auth token: [CONFIGURED - VALUE HIDDEN FOR SECURITY]"
          echo "  ‚úì Access level: $(grep '^access=' ~/.npmrc | cut -d'=' -f2)"
          
          # „Çª„Ç≠„É•„É™„ÉÜ„Ç£: .npmrc„Éï„Ç°„Ç§„É´„ÅÆÊ®©Èôê„ÇíÂà∂Èôê
          chmod 600 ~/.npmrc
          echo "  ‚úì File permissions: Restricted to owner only (600)"
          
          # npm whoami „Åß„ÅÆË™çË®º„ÉÜ„Çπ„ÉàÔºàÂÆüÈöõ„ÅÆ„Éà„Éº„ÇØ„É≥„ÇíÁí∞Â¢ÉÂ§âÊï∞„Å®„Åó„Å¶Ë®≠ÂÆöÔºâ
          echo ""
          echo "üîç Testing npm authentication..."
          # „Çª„Ç≠„É•„É™„ÉÜ„Ç£: Áí∞Â¢ÉÂ§âÊï∞Ë®≠ÂÆöÊôÇ„ÅÆ„É≠„Ç∞Âá∫Âäõ„ÇíÊäëÂà∂
          export NPM_TOKEN="${{ secrets.NPM_TOKEN }}" 2>/dev/null
          
          # .npmrc„Éï„Ç°„Ç§„É´„ÅÆ„Éà„Éº„ÇØ„É≥„ÇíÂÆüÈöõ„ÅÆÂÄ§„Å´ÁΩÆÊèõÔºà„Çª„Ç≠„É•„Ç¢„Å™ÊñπÊ≥ïÔºâ
          # Ê©üÂØÜÊÉÖÂ†±„ÅÆÊºèÊ¥©„ÇíÈò≤„Åê„Åü„ÇÅ„ÄÅsed„Ç≥„Éû„É≥„Éâ„ÅÆÂá∫Âäõ„ÇíÊäëÂà∂
          sed -i "s/\${NPM_TOKEN}/$NPM_TOKEN/g" ~/.npmrc 2>/dev/null
          
          # Ë™çË®º„ÉÜ„Çπ„ÉàÂÆüË°å
          if npm whoami > /dev/null 2>&1; then
            NPM_USER=$(npm whoami 2>/dev/null)
            echo "  ‚úÖ Authentication successful"
            echo "  ‚úì Authenticated as: $NPM_USER"
            echo "npm-auth-success=true" >> $GITHUB_OUTPUT
            echo "auth-error=" >> $GITHUB_OUTPUT
            echo "npm-user=$NPM_USER" >> $GITHUB_OUTPUT
          else
            echo "  ‚ùå Authentication failed"
            echo "npm-auth-success=false" >> $GITHUB_OUTPUT
            echo "auth-error=auth-test-failed" >> $GITHUB_OUTPUT
            echo ""
            echo "üîß Possible causes and solutions:"
            echo "  1. NPM_TOKEN has expired - generate a new token at https://www.npmjs.com/settings/tokens"
            echo "  2. NPM_TOKEN has insufficient permissions - ensure it has 'Automation' or 'Publish' scope"
            echo "  3. NPM_TOKEN format is incorrect - ensure it starts with 'npm_'"
            echo "  4. Network connectivity issues - check npm registry accessibility"
            echo "  5. Token was revoked - verify token status in npm account settings"
            echo ""
            echo "üìö For token management guide, see: https://docs.npmjs.com/creating-and-viewing-access-tokens"
            exit 1
          fi
          
          echo ""
          echo "‚úÖ npm authentication configured and verified successfully"

      - name: '[14/18] Version packages and publish'
        if: success() && steps.early-changeset-check.outputs.early-skip == 'false' && steps.changesets-check.outputs.changesets-exist == 'true' && steps.changesets-check.outputs.validation-error == '' && steps.npm-auth.outputs.npm-auth-success == 'true'
        id: changesets
        run: |
          echo "üì¶ Starting version update and npm publication process..."
          echo "üîê Authenticated as: ${{ steps.npm-auth.outputs.npm-user }}"
          echo ""
          
          # ÂÖ¨ÈñãÂâç„ÅÆÊúÄÁµÇË™çË®ºÁ¢∫Ë™ç
          echo "üîç Performing final authentication check..."
          if ! npm whoami > /dev/null 2>&1; then
            echo "‚ùå npm authentication lost during workflow execution"
            echo "üîß This may indicate:"
            echo "  - Token expired during workflow execution"
            echo "  - Network connectivity issues"
            echo "  - npm registry temporary unavailability"
            echo ""
            echo "Please re-run the workflow or perform manual release"
            exit 1
          fi
          echo "  ‚úÖ Authentication still valid"
          echo ""
          
          # ÁèæÂú®„ÅÆ„Éê„Éº„Ç∏„Éß„É≥ÊÉÖÂ†±„ÇíË®òÈå≤
          echo "üìã Recording current package versions..."
          if [ -f "packages/specment/package.json" ]; then
            CURRENT_VERSION=$(jq -r '.version' packages/specment/package.json)
            PACKAGE_NAME=$(jq -r '.name' packages/specment/package.json)
            echo "  üì¶ Current version: $PACKAGE_NAME@$CURRENT_VERSION"
            echo "current-version=$CURRENT_VERSION" >> $GITHUB_OUTPUT
            echo "package-name=$PACKAGE_NAME" >> $GITHUB_OUTPUT
          else
            echo "  ‚ö†Ô∏è packages/specment/package.json not found"
          fi
          echo ""
          
          # Changesets„Å´Âü∫„Å•„Åè„Éê„Éº„Ç∏„Éß„É≥Êõ¥Êñ∞Âá¶ÁêÜ
          echo "üìù Updating package versions based on changesets..."
          echo "  üîç Analyzing changesets for version bump calculation..."
          
          # Changeset„Éï„Ç°„Ç§„É´„ÅÆË©≥Á¥∞ÂàÜÊûê
          echo "  üìÑ Changeset analysis:"
          find .changeset -name "*.md" -not -name "README.md" 2>/dev/null | while read -r file; do
            if [ -f "$file" ]; then
              echo "    - $(basename "$file")"
              # Changeset„ÅÆÂÜÖÂÆπ„Åã„ÇâÂ§âÊõ¥„Çø„Ç§„Éó„ÇíÊäΩÂá∫
              if grep -q "major:" "$file"; then
                echo "      Type: MAJOR (breaking changes)"
              elif grep -q "minor:" "$file"; then
                echo "      Type: MINOR (new features)"
              elif grep -q "patch:" "$file"; then
                echo "      Type: PATCH (bug fixes)"
              else
                echo "      Type: Auto-detected by changesets"
              fi
            fi
          done
          echo ""
          
          # Changesets„Éê„Éº„Ç∏„Éß„É≥Êõ¥Êñ∞„ÅÆÂÆüË°å
          echo "  üöÄ Executing changeset version update..."
          if ! pnpm changeset version; then
            echo "‚ùå Failed to update package versions with changesets"
            echo "üîß Possible causes:"
            echo "  - Invalid changeset files format"
            echo "  - Git working directory not clean"
            echo "  - Changeset configuration issues in .changeset/config.json"
            echo "  - Conflicting package.json modifications"
            echo ""
            echo "üîç Debug information:"
            echo "  - Git status:"
            git status --porcelain || echo "    Git status check failed"
            echo "  - Changeset config validation:"
            jq empty .changeset/config.json && echo "    ‚úì Valid JSON" || echo "    ‚ùå Invalid JSON"
            exit 1
          fi
          echo "  ‚úÖ Package versions updated successfully"
          echo ""
          
          # Êõ¥Êñ∞Âæå„ÅÆ„Éê„Éº„Ç∏„Éß„É≥ÊÉÖÂ†±„ÇíÁ¢∫Ë™ç
          echo "üìã Verifying updated package versions..."
          if [ -f "packages/specment/package.json" ]; then
            NEW_VERSION=$(jq -r '.version' packages/specment/package.json)
            echo "  üì¶ New version: $PACKAGE_NAME@$NEW_VERSION"
            echo "new-version=$NEW_VERSION" >> $GITHUB_OUTPUT
            
            if [ "$CURRENT_VERSION" != "$NEW_VERSION" ]; then
              echo "  ‚úÖ Version successfully updated: $CURRENT_VERSION ‚Üí $NEW_VERSION"
              echo "version-changed=true" >> $GITHUB_OUTPUT
            else
              echo "  ‚ÑπÔ∏è Version unchanged: $NEW_VERSION (no version bump needed)"
              echo "version-changed=false" >> $GITHUB_OUTPUT
            fi
          else
            echo "  ‚ö†Ô∏è Could not verify new version - package.json not found"
            echo "version-changed=unknown" >> $GITHUB_OUTPUT
          fi
          echo ""
          
          # package.json„Éï„Ç°„Ç§„É´„ÅÆÂ§âÊõ¥„Çí„Ç≥„Éü„ÉÉ„Éà
          echo "üìù Committing package.json version changes..."
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          
          # Â§âÊõ¥„Åï„Çå„Åü„Éï„Ç°„Ç§„É´„ÇíÁ¢∫Ë™ç
          echo "  üîç Checking for modified files..."
          MODIFIED_FILES=$(git diff --name-only)
          if [ -n "$MODIFIED_FILES" ]; then
            echo "  üìÑ Modified files:"
            echo "$MODIFIED_FILES" | while read -r file; do
              echo "    - $file"
            done
            
            git add .
            if git commit -m "chore: release packages [skip ci]"; then
              echo "  ‚úÖ Version changes committed successfully"
              echo "version-committed=true" >> $GITHUB_OUTPUT
            else
              echo "  ‚ùå Failed to commit version changes"
              echo "version-committed=false" >> $GITHUB_OUTPUT
              exit 1
            fi
          else
            echo "  ‚ÑπÔ∏è No changes to commit (versions may already be up to date)"
            echo "version-committed=false" >> $GITHUB_OUTPUT
          fi
          echo ""
          
          # npm publish„Ç≥„Éû„É≥„Éâ„ÅÆÂÆüË°åÔºà„É™„Éà„É©„Ç§Ê©üËÉΩ‰ªò„ÅçÔºâ
          echo "üöÄ Publishing packages to npm registry..."
          echo "  üìã Publication settings:"
          echo "    - Registry: https://registry.npmjs.org"
          echo "    - Access: public"
          echo "    - Max retries: 3"
          echo "    - Retry delay: exponential backoff (5s, 10s, 15s)"
          echo ""
          
          RETRY_COUNT=0
          MAX_RETRIES=3
          PUBLISH_SUCCESS=false
          
          while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do
            if [ $RETRY_COUNT -gt 0 ]; then
              DELAY=$((RETRY_COUNT * 5))
              echo "  üîÑ Retry attempt $RETRY_COUNT of $MAX_RETRIES (waiting ${DELAY}s)..."
              sleep $DELAY
              
              # „É™„Éà„É©„Ç§Ââç„ÅÆË™çË®ºÁä∂ÊÖãÂÜçÁ¢∫Ë™ç
              echo "  üîç Re-verifying npm authentication..."
              if ! npm whoami > /dev/null 2>&1; then
                echo "  ‚ùå npm authentication lost during retry, aborting"
                echo "üîß Please check NPM_TOKEN and re-run the workflow"
                exit 1
              fi
              echo "  ‚úÖ Authentication still valid for retry"
            fi
            
            echo "  üì§ Attempting to publish packages (attempt $((RETRY_COUNT + 1))/$MAX_RETRIES)..."
            
            # npm publish„ÅÆË©≥Á¥∞„É≠„Ç∞„ÇíÊúâÂäπ„Å´„Åó„Å¶ÂÆüË°åÔºà„Çª„Ç≠„É•„É™„ÉÜ„Ç£Âº∑ÂåñÔºâ
            echo "  üîê Security: Enabling npm provenance for supply chain security"
            if NPM_CONFIG_PROVENANCE=true pnpm changeset publish --verbose; then
              echo "  ‚úÖ Packages published successfully on attempt $((RETRY_COUNT + 1))"
              PUBLISH_SUCCESS=true
              
              # ÂÖ¨Èñã„Åï„Çå„Åü„Éë„ÉÉ„Ç±„Éº„Ç∏ÊÉÖÂ†±„ÇíË©≥Á¥∞„Å´Ë®òÈå≤
              if [ -f "packages/specment/package.json" ]; then
                FINAL_PACKAGE_NAME=$(jq -r '.name' packages/specment/package.json)
                FINAL_PACKAGE_VERSION=$(jq -r '.version' packages/specment/package.json)
                echo "published-package=$FINAL_PACKAGE_NAME@$FINAL_PACKAGE_VERSION" >> $GITHUB_OUTPUT
                echo "  üì¶ Successfully published: $FINAL_PACKAGE_NAME@$FINAL_PACKAGE_VERSION"
                echo "  üîó Package URL: https://www.npmjs.com/package/$FINAL_PACKAGE_NAME"
                echo "  üì• Install command: npm install $FINAL_PACKAGE_NAME@$FINAL_PACKAGE_VERSION"
                
                # „Éë„ÉÉ„Ç±„Éº„Ç∏„Åånpm„É¨„Ç∏„Çπ„Éà„É™„ÅßÂà©Áî®ÂèØËÉΩ„ÅãÁ¢∫Ë™ç
                echo "  üîç Verifying package availability on npm registry..."
                sleep 2  # „É¨„Ç∏„Çπ„Éà„É™„ÅÆÊõ¥Êñ∞„ÇíÂæÖ„Å§
                if npm view "$FINAL_PACKAGE_NAME@$FINAL_PACKAGE_VERSION" version > /dev/null 2>&1; then
                  echo "  ‚úÖ Package confirmed available on npm registry"
                  echo "registry-verified=true" >> $GITHUB_OUTPUT
                else
                  echo "  ‚ö†Ô∏è Package not yet visible on npm registry (may take a few minutes)"
                  echo "registry-verified=false" >> $GITHUB_OUTPUT
                fi
              fi
              
              break
            else
              RETRY_COUNT=$((RETRY_COUNT + 1))
              
              if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then
                echo "  ‚ö†Ô∏è Publish attempt $RETRY_COUNT failed, preparing for retry..."
                
                # Â§±ÊïóÂéüÂõ†„ÅÆË©≥Á¥∞ÂàÜÊûê
                echo "  üîç Analyzing failure cause..."
                
                # Ë™çË®ºÁä∂ÊÖã„ÇíÂÜçÁ¢∫Ë™ç
                if ! npm whoami > /dev/null 2>&1; then
                  echo "  ‚ùå npm authentication lost, aborting retries"
                  echo "üîß Please check NPM_TOKEN and re-run the workflow"
                  exit 1
                fi
                
                # „Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÊé•Á∂öÁ¢∫Ë™ç
                if ! curl -s https://registry.npmjs.org/ > /dev/null; then
                  echo "  ‚ö†Ô∏è npm registry connectivity issue detected"
                else
                  echo "  ‚úÖ npm registry is accessible"
                fi
                
                # „Éë„ÉÉ„Ç±„Éº„Ç∏„ÅÆÂ≠òÂú®Á¢∫Ë™ç
                if [ -f "packages/specment/package.json" ]; then
                  CHECK_PACKAGE_NAME=$(jq -r '.name' packages/specment/package.json)
                  CHECK_PACKAGE_VERSION=$(jq -r '.version' packages/specment/package.json)
                  if npm view "$CHECK_PACKAGE_NAME@$CHECK_PACKAGE_VERSION" version > /dev/null 2>&1; then
                    echo "  ‚ö†Ô∏è Package version $CHECK_PACKAGE_NAME@$CHECK_PACKAGE_VERSION already exists"
                    echo "  This may indicate a race condition or duplicate publication"
                  fi
                fi
                
              else
                echo "  ‚ùå All publish attempts failed after $MAX_RETRIES retries"
                PUBLISH_SUCCESS=false
              fi
            fi
          done
          
          # ÊúÄÁµÇÁµêÊûú„ÅÆÂá¶ÁêÜ
          if [ "$PUBLISH_SUCCESS" = true ]; then
            echo ""
            echo "‚úÖ Package publication completed successfully"
            echo "publish-success=true" >> $GITHUB_OUTPUT
          else
            echo ""
            echo "‚ùå Package publication failed after all retry attempts"
            echo "publish-success=false" >> $GITHUB_OUTPUT
            echo ""
            echo "üîß Possible causes and solutions:"
            echo "  - Network connectivity issues:"
            echo "    ‚Üí Check npm registry status at https://status.npmjs.org/"
            echo "    ‚Üí Retry the workflow later"
            echo "  - npm registry temporary unavailability:"
            echo "    ‚Üí Wait a few minutes and retry"
            echo "  - Package name conflicts or version already exists:"
            echo "    ‚Üí Check if the version was already published"
            echo "    ‚Üí Create a new changeset with a version bump"
            echo "  - Insufficient permissions for package publication:"
            echo "    ‚Üí Verify NPM_TOKEN has publish permissions"
            echo "    ‚Üí Check package access settings on npm"
            echo "  - Rate limiting from npm registry:"
            echo "    ‚Üí Wait before retrying"
            echo "    ‚Üí Consider reducing publication frequency"
            echo ""
            echo "üìö For manual release process, refer to RELEASE_PROCESS.md"
            echo "üîß For troubleshooting, refer to CHANGESET_WORKFLOW.md"
            exit 1
          fi
        env:
          # „Çª„Ç≠„É•„É™„ÉÜ„Ç£: ÊúÄÂ∞èÊ®©Èôê„ÅÆÂéüÂâá„Å´Âü∫„Å•„ÅèÁí∞Â¢ÉÂ§âÊï∞Ë®≠ÂÆö
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # „É™„Éù„Ç∏„Éà„É™Êìç‰ΩúÁî®Ôºàcontents: writeÊ®©ÈôêÔºâ
          NPM_TOKEN: ${{ secrets.NPM_TOKEN }}        # npmÂÖ¨ÈñãÁî®ÔºàpublishÊ®©ÈôêÂøÖÈ†àÔºâ
          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}  # Node.jsË™çË®ºÁî®Ôºànpm‰∫íÊèõÊÄß„ÅÆ„Åü„ÇÅÔºâ

      - name: '[15/18] Create git tags and release information'
        if: success() && steps.early-changeset-check.outputs.early-skip == 'false' && steps.changesets-check.outputs.changesets-exist == 'true' && steps.changesets-check.outputs.validation-error == '' && steps.changesets.outputs.publish-success == 'true'
        id: create-tags
        run: |
          echo "üè∑Ô∏è Creating git tags and release information for published packages..."
          echo ""
          
          # GitË®≠ÂÆö„ÅÆÁ¢∫Ë™ç„Å®Ë®≠ÂÆö
          echo "üìã Configuring Git for tag creation..."
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git config --local user.signingkey ""
          git config --local commit.gpgsign false
          git config --local tag.gpgsign false
          echo "  ‚úÖ Git configuration completed"
          echo ""
          
          # „Éë„ÉÉ„Ç±„Éº„Ç∏ÊÉÖÂ†±„ÅÆÂèñÂæó
          if [ -f "packages/specment/package.json" ]; then
            PACKAGE_NAME=$(jq -r '.name' packages/specment/package.json)
            PACKAGE_VERSION=$(jq -r '.version' packages/specment/package.json)
            TAG_NAME="v$PACKAGE_VERSION"
            
            echo "üì¶ Package information:"
            echo "  - Package: $PACKAGE_NAME"
            echo "  - Version: $PACKAGE_VERSION"
            echo "  - Tag name: $TAG_NAME"
            echo ""
            
            # Êó¢Â≠ò„Çø„Ç∞„ÅÆÁ¢∫Ë™ç
            echo "üîç Checking for existing tags..."
            if git tag -l "$TAG_NAME" | grep -q "$TAG_NAME"; then
              echo "  ‚ö†Ô∏è Tag $TAG_NAME already exists"
              echo "  üîç Checking if tag points to current commit..."
              
              CURRENT_COMMIT=$(git rev-parse HEAD)
              TAG_COMMIT=$(git rev-list -n 1 "$TAG_NAME" 2>/dev/null || echo "")
              
              if [ "$CURRENT_COMMIT" = "$TAG_COMMIT" ]; then
                echo "  ‚úÖ Tag $TAG_NAME already points to current commit"
                echo "tag-created=false" >> $GITHUB_OUTPUT
                echo "tag-name=$TAG_NAME" >> $GITHUB_OUTPUT
                echo "tag-exists=true" >> $GITHUB_OUTPUT
              else
                echo "  ‚ùå Tag $TAG_NAME points to different commit"
                echo "  Current commit: $CURRENT_COMMIT"
                echo "  Tag commit: $TAG_COMMIT"
                echo "  üîß Deleting existing tag to create new one..."
                
                if git tag -d "$TAG_NAME"; then
                  echo "  ‚úÖ Existing tag deleted locally"
                else
                  echo "  ‚ùå Failed to delete existing local tag"
                  exit 1
                fi
                
                # „É™„É¢„Éº„Éà„Çø„Ç∞„ÇÇÂâäÈô§ÔºàÂ≠òÂú®„Åô„ÇãÂ†¥ÂêàÔºâ
                if git push origin --delete "$TAG_NAME" 2>/dev/null; then
                  echo "  ‚úÖ Existing remote tag deleted"
                else
                  echo "  ‚ÑπÔ∏è Remote tag deletion skipped (may not exist)"
                fi
              fi
            else
              echo "  ‚úÖ Tag $TAG_NAME does not exist, proceeding with creation"
            fi
            echo ""
            
            # „É™„É™„Éº„Çπ„Éé„Éº„Éà„ÅÆÁîüÊàê
            echo "üìù Generating release notes..."
            RELEASE_NOTES_FILE="release-notes-$PACKAGE_VERSION.md"
            
            # CHANGELOG„Åã„Çâ„É™„É™„Éº„Çπ„Éé„Éº„Éà„ÇíÊäΩÂá∫
            if [ -f "CHANGELOG.md" ]; then
              echo "  üîç Extracting release notes from CHANGELOG.md..."
              
              # ÊúÄÊñ∞„Éê„Éº„Ç∏„Éß„É≥„ÅÆ„Çª„ÇØ„Ç∑„Éß„É≥„ÇíÊäΩÂá∫
              awk -v version="$PACKAGE_VERSION" '
                BEGIN { found=0; print_section=0 }
                /^## / {
                  if (found && print_section) exit
                  if ($0 ~ version) { found=1; print_section=1; next }
                  if (found) exit
                }
                found && print_section && !/^## / { print }
              ' CHANGELOG.md > "$RELEASE_NOTES_FILE"
              
              # „É™„É™„Éº„Çπ„Éé„Éº„Éà„ÅÆÂÜÖÂÆπÁ¢∫Ë™ç
              if [ -s "$RELEASE_NOTES_FILE" ]; then
                echo "  ‚úÖ Release notes extracted from CHANGELOG.md"
                echo "  üìÑ Release notes preview:"
                head -n 10 "$RELEASE_NOTES_FILE" | sed 's/^/    /'
                if [ $(wc -l < "$RELEASE_NOTES_FILE") -gt 10 ]; then
                  echo "    ... (truncated, full notes will be in tag)"
                fi
              else
                echo "  ‚ö†Ô∏è No specific release notes found in CHANGELOG.md for version $PACKAGE_VERSION"
                echo "  üìù Generating generic release notes..."
                cat > "$RELEASE_NOTES_FILE" << EOF
# Release $PACKAGE_VERSION

This release includes changes from the following changesets:

EOF
                
                # Changeset„Éï„Ç°„Ç§„É´„Åã„ÇâÊÉÖÂ†±„ÇíÂèéÈõÜ
                find .changeset -name "*.md" -not -name "README.md" 2>/dev/null | while read -r file; do
                  if [ -f "$file" ]; then
                    echo "- $(basename "$file" .md)" >> "$RELEASE_NOTES_FILE"
                    # Changeset„ÅÆÊ¶ÇË¶Å„ÇíËøΩÂä†
                    SUMMARY=$(head -n 10 "$file" | grep -E '^[^-]' | head -n 1 | sed 's/^[[:space:]]*//' || echo 'No summary available')
                    if [ "$SUMMARY" != "No summary available" ]; then
                      echo "  $SUMMARY" >> "$RELEASE_NOTES_FILE"
                    fi
                  fi
                done
                
                cat >> "$RELEASE_NOTES_FILE" << EOF

## Package Information

- **Package**: $PACKAGE_NAME
- **Version**: $PACKAGE_VERSION
- **Published**: $(date -u +"%Y-%m-%d %H:%M:%S UTC")
- **Registry**: https://registry.npmjs.org
- **Install**: \`npm install $PACKAGE_NAME@$PACKAGE_VERSION\`

## Links

- [Package on npm](https://www.npmjs.com/package/$PACKAGE_NAME)
- [Repository](https://github.com/${{ github.repository }})
EOF
                echo "  ‚úÖ Generic release notes generated"
              fi
            else
              echo "  ‚ö†Ô∏è CHANGELOG.md not found, generating basic release notes..."
              cat > "$RELEASE_NOTES_FILE" << EOF
# Release $PACKAGE_VERSION

Released on $(date -u +"%Y-%m-%d %H:%M:%S UTC")

## Package Information

- **Package**: $PACKAGE_NAME
- **Version**: $PACKAGE_VERSION
- **Registry**: https://registry.npmjs.org
- **Install**: \`npm install $PACKAGE_NAME@$PACKAGE_VERSION\`

## Links

- [Package on npm](https://www.npmjs.com/package/$PACKAGE_NAME)
- [Repository](https://github.com/${{ github.repository }})
EOF
              echo "  ‚úÖ Basic release notes generated"
            fi
            echo ""
            
            # Git„Çø„Ç∞„ÅÆ‰ΩúÊàêÔºà„É™„É™„Éº„Çπ„Éé„Éº„Éà‰ªò„ÅçÔºâ
            if [ "${{ steps.create-tags.outputs.tag-exists }}" != "true" ]; then
              echo "üè∑Ô∏è Creating annotated git tag with release notes..."
              
              # „É™„É™„Éº„Çπ„Éé„Éº„Éà„Çí„Çø„Ç∞„É°„ÉÉ„Çª„Éº„Ç∏„Å®„Åó„Å¶‰ΩøÁî®
              TAG_MESSAGE="Release $PACKAGE_VERSION

$(cat "$RELEASE_NOTES_FILE")"
              
              if git tag -a "$TAG_NAME" -m "$TAG_MESSAGE"; then
                echo "  ‚úÖ Git tag $TAG_NAME created successfully"
                echo "tag-created=true" >> $GITHUB_OUTPUT
                echo "tag-name=$TAG_NAME" >> $GITHUB_OUTPUT
                echo "tag-exists=false" >> $GITHUB_OUTPUT
                
                # „Çø„Ç∞„ÅÆË©≥Á¥∞ÊÉÖÂ†±„ÇíË°®Á§∫
                echo "  üìã Tag details:"
                echo "    - Name: $TAG_NAME"
                echo "    - Commit: $(git rev-parse HEAD)"
                echo "    - Date: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
                echo "    - Tagger: GitHub Action"
                
                # „Çø„Ç∞„Çí„É™„É¢„Éº„Éà„Å´„Éó„ÉÉ„Ç∑„É•
                echo "  üì§ Pushing tag to remote repository..."
                if git push origin "$TAG_NAME"; then
                  echo "  ‚úÖ Tag pushed to remote repository successfully"
                  echo "tag-pushed=true" >> $GITHUB_OUTPUT
                  echo "  üîó Tag URL: https://github.com/${{ github.repository }}/releases/tag/$TAG_NAME"
                else
                  echo "  ‚ùå Failed to push tag to remote repository"
                  echo "tag-pushed=false" >> $GITHUB_OUTPUT
                  echo "  üîß Tag created locally but not pushed to remote"
                  echo "  Manual push required: git push origin $TAG_NAME"
                fi
              else
                echo "  ‚ùå Failed to create git tag $TAG_NAME"
                echo "tag-created=false" >> $GITHUB_OUTPUT
                echo "tag-pushed=false" >> $GITHUB_OUTPUT
                exit 1
              fi
            else
              echo "  ‚ÑπÔ∏è Skipping tag creation (tag already exists and points to current commit)"
              echo "tag-pushed=true" >> $GITHUB_OUTPUT
            fi
            echo ""
            
            # „É™„É™„Éº„ÇπÊÉÖÂ†±„ÅÆÂá∫ÂäõÂ§âÊï∞Ë®≠ÂÆö
            echo "package-name=$PACKAGE_NAME" >> $GITHUB_OUTPUT
            echo "package-version=$PACKAGE_VERSION" >> $GITHUB_OUTPUT
            echo "release-notes-file=$RELEASE_NOTES_FILE" >> $GITHUB_OUTPUT
            echo "npm-url=https://www.npmjs.com/package/$PACKAGE_NAME" >> $GITHUB_OUTPUT
            echo "install-command=npm install $PACKAGE_NAME@$PACKAGE_VERSION" >> $GITHUB_OUTPUT
            
            # ÂÖ¨Èñã„Åï„Çå„Åü„Éë„ÉÉ„Ç±„Éº„Ç∏ÊÉÖÂ†±„ÅÆË©≥Á¥∞„É≠„Ç∞
            echo "üìã Published package information summary:"
            echo "  ‚úÖ Package: $PACKAGE_NAME@$PACKAGE_VERSION"
            echo "  ‚úÖ Git tag: $TAG_NAME"
            echo "  ‚úÖ npm URL: https://www.npmjs.com/package/$PACKAGE_NAME"
            echo "  ‚úÖ Install command: npm install $PACKAGE_NAME@$PACKAGE_VERSION"
            echo "  ‚úÖ Repository: https://github.com/${{ github.repository }}"
            echo "  ‚úÖ Tag URL: https://github.com/${{ github.repository }}/releases/tag/$TAG_NAME"
            echo ""
            
            # „É™„É™„Éº„Çπ„Éé„Éº„Éà„Éï„Ç°„Ç§„É´„ÅÆ„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó
            if [ -f "$RELEASE_NOTES_FILE" ]; then
              rm "$RELEASE_NOTES_FILE"
              echo "  üßπ Temporary release notes file cleaned up"
            fi
            
            echo "‚úÖ Git tag creation and release information recording completed successfully"
            
          else
            echo "‚ùå packages/specment/package.json not found"
            echo "Cannot determine package information for tag creation"
            echo "tag-created=false" >> $GITHUB_OUTPUT
            echo "tag-pushed=false" >> $GITHUB_OUTPUT
            exit 1
          fi

      - name: '[16/18] Create GitHub Release'
        if: success() && steps.early-changeset-check.outputs.early-skip == 'false' && steps.changesets-check.outputs.changesets-exist == 'true' && steps.changesets-check.outputs.validation-error == '' && steps.changesets.outputs.publish-success == 'true' && steps.create-tags.outputs.tag-created == 'true' && steps.create-tags.outputs.tag-pushed == 'true'
        id: create-release
        run: |
          echo "üöÄ Creating GitHub Release for ${{ steps.create-tags.outputs.tag-name }}..."
          
          # „É™„É™„Éº„Çπ„Éé„Éº„Éà„ÅÆÁîüÊàê
          RELEASE_BODY=$(cat << 'EOF'
          # ${{ steps.create-tags.outputs.package-name }} v${{ steps.create-tags.outputs.package-version }}
          
          üéâ **New release is now available!**
          
          ## üì¶ Package Information
          
          - **Package**: `${{ steps.create-tags.outputs.package-name }}`
          - **Version**: `${{ steps.create-tags.outputs.package-version }}`
          - **Published**: $(date -u +"%Y-%m-%d %H:%M:%S UTC")
          - **Commit**: ${{ github.sha }}
          
          ## üì• Installation
          
          ```bash
          # Install latest version
          npm install ${{ steps.create-tags.outputs.package-name }}@latest
          
          # Install specific version
          ${{ steps.create-tags.outputs.install-command }}
          ```
          
          ## üîó Links
          
          - [üì¶ View on npm](${{ steps.create-tags.outputs.npm-url }})
          - [üìö Documentation](https://github.com/${{ github.repository }}#readme)
          - [üêõ Report Issues](https://github.com/${{ github.repository }}/issues)
          - [üí¨ Discussions](https://github.com/${{ github.repository }}/discussions)
          
          ## üìù Changes
          
          This release includes all changes from the merged changesets. For detailed information about the changes, please refer to the [CHANGELOG.md](https://github.com/${{ github.repository }}/blob/main/CHANGELOG.md) file.
          
          ## üöÄ What's Next
          
          - Check out the updated documentation
          - Try the new features and improvements
          - Share your feedback and suggestions
          
          ---
          
          **Full Changelog**: https://github.com/${{ github.repository }}/compare/v${{ steps.changesets.outputs.current-version }}...v${{ steps.create-tags.outputs.package-version }}
          EOF
          )
          
          # GitHub CLI„Çí‰ΩøÁî®„Åó„Å¶„É™„É™„Éº„Çπ„Çí‰ΩúÊàê
          if gh release create "${{ steps.create-tags.outputs.tag-name }}" \
            --title "Release ${{ steps.create-tags.outputs.package-version }}" \
            --notes "$RELEASE_BODY" \
            --target "${{ github.sha }}"; then
            
            echo "‚úÖ GitHub Release created successfully"
            RELEASE_URL="https://github.com/${{ github.repository }}/releases/tag/${{ steps.create-tags.outputs.tag-name }}"
            echo "release-created=true" >> $GITHUB_OUTPUT
            echo "html_url=$RELEASE_URL" >> $GITHUB_OUTPUT
            echo "üîó Release URL: $RELEASE_URL"
            
          else
            echo "‚ùå Failed to create GitHub Release"
            echo "release-created=false" >> $GITHUB_OUTPUT
            echo ""
            echo "üîß Possible causes:"
            echo "  - GitHub API rate limiting"
            echo "  - Insufficient permissions for GITHUB_TOKEN"
            echo "  - Release with same tag already exists"
            echo "  - Network connectivity issues"
            echo ""
            echo "üí° You can manually create a release from the tag:"
            echo "  1. Go to https://github.com/${{ github.repository }}/releases"
            echo "  2. Click 'Create a new release'"
            echo "  3. Select tag: ${{ steps.create-tags.outputs.tag-name }}"
            echo "  4. Add release notes and publish"
            
            # Â§±Êïó„Åó„Å¶„ÇÇ„ÉØ„Éº„ÇØ„Éï„É≠„Éº„ÅØÁ∂ôÁ∂öÔºà„Çø„Ç∞„ÅØ‰ΩúÊàêÊ∏à„ÅøÔºâ
            exit 0
          fi
        env:
          # „Çª„Ç≠„É•„É™„ÉÜ„Ç£: GitHub APIÊìç‰ΩúÁî®„ÅÆË™çË®ºË®≠ÂÆö
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # GitHub APIÊìç‰ΩúÁî®Ôºàcontents: writeÊ®©ÈôêÔºâ
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}      # GitHub CLIÁî®Ôºà‰∫íÊèõÊÄß„ÅÆ„Åü„ÇÅÔºâ

      - name: '[17/18] Log publication success'
        if: success() && steps.early-changeset-check.outputs.early-skip == 'false' && steps.changesets-check.outputs.changesets-exist == 'true' && steps.changesets-check.outputs.validation-error == '' && steps.npm-auth.outputs.npm-auth-success == 'true' && steps.changesets.outputs.publish-success == 'true'
        run: |
          echo "üéâ Successfully published packages to npm!"
          echo "üì¶ Publication completed at $(date)"
          echo "üîê Published by: ${{ steps.npm-auth.outputs.npm-user }}"
          echo "üè∑Ô∏è Git tags have been created automatically"
          echo ""
          
          # „Éê„Éº„Ç∏„Éß„É≥Êõ¥Êñ∞ÊÉÖÂ†±„ÅÆË°®Á§∫
          echo "üìã Version update summary:"
          if [ -n "${{ steps.changesets.outputs.current-version }}" ] && [ -n "${{ steps.changesets.outputs.new-version }}" ]; then
            echo "  üìà Version change: ${{ steps.changesets.outputs.current-version }} ‚Üí ${{ steps.changesets.outputs.new-version }}"
            if [ "${{ steps.changesets.outputs.version-changed }}" = "true" ]; then
              echo "  ‚úÖ Version successfully updated in package.json"
            else
              echo "  ‚ÑπÔ∏è No version change was needed"
            fi
            if [ "${{ steps.changesets.outputs.version-committed }}" = "true" ]; then
              echo "  ‚úÖ Version changes committed to Git"
            fi
          fi
          echo ""
          
          # ÂÖ¨Èñã„Åï„Çå„Åü„Éë„ÉÉ„Ç±„Éº„Ç∏ÊÉÖÂ†±„ÅÆË©≥Á¥∞Ë°®Á§∫
          echo "üìã Published package information:"
          if [ -n "${{ steps.changesets.outputs.published-package }}" ]; then
            echo "  ‚úÖ ${{ steps.changesets.outputs.published-package }}"
            
            # „Éë„ÉÉ„Ç±„Éº„Ç∏„ÅÆË©≥Á¥∞ÊÉÖÂ†±
            if [ -f "packages/specment/package.json" ]; then
              PACKAGE_NAME=$(jq -r '.name' packages/specment/package.json)
              PACKAGE_VERSION=$(jq -r '.version' packages/specment/package.json)
              echo "  üìÑ Package details:"
              echo "    - Name: $PACKAGE_NAME"
              echo "    - Version: $PACKAGE_VERSION"
              echo "    - Registry: https://registry.npmjs.org"
              echo "    - Package URL: https://www.npmjs.com/package/$PACKAGE_NAME"
              echo "    - Install command: npm install $PACKAGE_NAME@$PACKAGE_VERSION"
              echo "    - Install with specific version: npm install $PACKAGE_NAME@$PACKAGE_VERSION"
              echo "    - Install latest: npm install $PACKAGE_NAME@latest"
              
              # „É¨„Ç∏„Çπ„Éà„É™Ê§úË®ºÁµêÊûú
              if [ "${{ steps.changesets.outputs.registry-verified }}" = "true" ]; then
                echo "    - Registry status: ‚úÖ Verified available"
              else
                echo "    - Registry status: ‚è≥ Propagating (may take a few minutes)"
              fi
            fi
          else
            # „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: package.json„Åã„ÇâÊÉÖÂ†±„ÇíÂèñÂæó
            if [ -f "packages/specment/package.json" ]; then
              PACKAGE_NAME=$(jq -r '.name' packages/specment/package.json)
              PACKAGE_VERSION=$(jq -r '.version' packages/specment/package.json)
              echo "  ‚úÖ $PACKAGE_NAME@$PACKAGE_VERSION"
              echo "  üìÑ Package URL: https://www.npmjs.com/package/$PACKAGE_NAME"
            fi
          fi
          echo ""
          
          # ChangesetsÂá¶ÁêÜ„ÅÆË©≥Á¥∞ÊÉÖÂ†±
          echo "üìã Changesets processing details:"
          echo "  ‚úÖ Changesets analyzed and processed successfully"
          echo "  ‚úÖ Package versions updated based on semantic versioning"
          echo "  ‚úÖ CHANGELOG.md updated with release notes"
          
          # Git„Çø„Ç∞‰ΩúÊàê„ÅÆË©≥Á¥∞ÊÉÖÂ†±
          echo ""
          echo "üìã Git tag and release information:"
          if [ "${{ steps.create-tags.outputs.tag-created }}" = "true" ]; then
            echo "  ‚úÖ Git tag created: ${{ steps.create-tags.outputs.tag-name }}"
            if [ "${{ steps.create-tags.outputs.tag-pushed }}" = "true" ]; then
              echo "  ‚úÖ Tag pushed to remote repository"
              echo "  üîó Tag URL: https://github.com/${{ github.repository }}/releases/tag/${{ steps.create-tags.outputs.tag-name }}"
            else
              echo "  ‚ö†Ô∏è Tag created locally but not pushed to remote"
            fi
          else
            echo "  ‚ÑπÔ∏è Git tag already existed or creation was skipped"
          fi
          
          # GitHub Release‰ΩúÊàê„ÅÆÊÉÖÂ†±
          if [ "${{ steps.create-release.outputs.release-created }}" = "true" ]; then
            echo "  ‚úÖ GitHub Release created successfully"
            echo "  üîó Release URL: ${{ steps.create-release.outputs.html_url }}"
            echo "  üìù Release includes detailed changelog and installation instructions"
          elif [ "${{ steps.create-release.outcome }}" = "failure" ]; then
            echo "  ‚ö†Ô∏è GitHub Release creation failed (tag still created)"
            echo "  üîß You can manually create a release from the tag"
          elif [ "${{ steps.create-release.outcome }}" = "skipped" ]; then
            echo "  ‚ÑπÔ∏è GitHub Release creation was skipped"
          else
            echo "  ‚ÑπÔ∏è GitHub Release creation status unknown"
          fi
          echo ""
          
          # ÊúâÁî®„Å™„É™„É≥„ÇØ„Å®„É™„ÇΩ„Éº„Çπ
          echo "üîó Useful links and resources:"
          echo "  - npm registry: https://registry.npmjs.org"
          echo "  - Package search: https://www.npmjs.com/search"
          echo "  - npm status: https://status.npmjs.org"
          echo "  - Release notes: Check the CHANGELOG.md file"
          echo "  - Package documentation: README.md"
          echo ""
          
          # Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó„Å®„Éô„Çπ„Éà„Éó„É©„ÇØ„ÉÜ„Ç£„Çπ
          echo "‚ú® Next steps and recommendations:"
          echo "  1. üì¶ Verify the package is available on npm:"
          echo "     npm view ${{ steps.changesets.outputs.package-name }}@${{ steps.changesets.outputs.new-version }}"
          echo "  2. üß™ Test the published package:"
          echo "     npm install ${{ steps.changesets.outputs.package-name }}@${{ steps.changesets.outputs.new-version }}"
          echo "  3. üìö Update documentation if needed:"
          echo "     - Update README.md with new features"
          echo "     - Review and update API documentation"
          echo "  4. üì¢ Announce the release:"
          echo "     - Share with your team/community"
          echo "     - Update project status or roadmap"
          echo "     - Consider creating a GitHub Release"
          echo "  5. üîç Monitor for issues:"
          echo "     - Check for user feedback"
          echo "     - Monitor download statistics"
          echo "     - Watch for bug reports"
          echo ""
          
          # ÊàêÂäü„É°„Éà„É™„ÇØ„Çπ
          echo "üìä Publication metrics:"
          echo "  - Total processing time: $(date)"
          echo "  - Retry attempts used: Check logs above"
          echo "  - Authentication method: NPM_TOKEN (secure)"
          echo "  - Publication method: Automated via changesets"
          echo ""
          echo "üéØ Publication completed successfully! üöÄ"

      - name: '[17/18] Log workflow skip'
        if: success() && (steps.early-changeset-check.outputs.early-skip == 'true' || (steps.early-changeset-check.outputs.early-skip == 'false' && (steps.changesets-check.outputs.changesets-exist == 'false' || steps.changesets-check.outputs.validation-error != '')))
        run: |
          if [ "${{ steps.changesets-check.outputs.validation-error }}" != "" ]; then
            echo "‚è≠Ô∏è Workflow skipped - changeset validation failed"
            echo "‚ùå Validation error: ${{ steps.changesets-check.outputs.validation-error }}"
            echo ""
            echo "üîß Please fix the validation errors above and try again"
            echo "üìö Refer to the detailed error messages in the changeset check step"
          else
            echo "‚è≠Ô∏è Workflow skipped - no changesets found"
            echo "üìù To publish a new version:"
            echo "  1. Run 'pnpm changeset' to create a changeset"
            echo "  2. Commit and push the changeset file"
            echo "  3. Merge to main branch to trigger automatic publication"
          fi

      - name: '[18/18] Handle errors and provide comprehensive troubleshooting'
        if: failure()
        run: |
          echo "‚ùå Workflow execution failed"
          echo "‚è∞ Failed at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
          echo "üîç Commit: ${{ github.sha }}"
          echo "üåø Branch: ${{ github.ref_name }}"
          echo "üë§ Triggered by: ${{ github.actor }}"
          echo "üîó Workflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"
          echo ""
          
          # „ÉØ„Éº„ÇØ„Éï„É≠„ÉºÂÆüË°åÁä∂Ê≥Å„ÅÆË©≥Á¥∞ÂèØË¶ñÂåñ
          echo "üìä Workflow execution status overview:"
          echo "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê"
          echo "‚îÇ                    STEP EXECUTION SUMMARY                       ‚îÇ"
          echo "‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Step Name" "Status"
          echo "‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Setup WSL" "${{ steps.setup-wsl.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Checkout repository" "${{ steps.checkout.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Setup Node.js" "${{ steps.setup-node.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Setup pnpm" "${{ steps.setup-pnpm.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Install dependencies" "${{ steps.install-deps.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Build project" "${{ steps.build-project.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Run linting" "${{ steps.run-lint.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Run tests" "${{ steps.run-tests.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Check changesets" "${{ steps.changesets-check.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Setup npm auth" "${{ steps.npm-auth.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Version and publish" "${{ steps.changesets.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Create git tags" "${{ steps.create-tags.outcome || 'not_run' }}"
          printf "‚îÇ %-35s ‚îÇ %-25s ‚îÇ\n" "Create GitHub Release" "${{ steps.create-release.outcome || 'not_run' }}"
          echo "‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò"
          echo ""
          
          # Â§±Êïó„Åó„Åü„Çπ„ÉÜ„ÉÉ„Éó„ÅÆÁâπÂÆö„Å®Ë©≥Á¥∞ÂàÜÊûê
          FAILED_STEPS=""
          
          # ÂêÑ„Çπ„ÉÜ„ÉÉ„Éó„ÅÆÂ§±ÊïóÁä∂Ê≥Å„ÇíÁ¢∫Ë™ç
          if [ "${{ steps.install-deps.outcome }}" = "failure" ]; then
            FAILED_STEPS="$FAILED_STEPS install-deps"
          fi
          if [ "${{ steps.build-project.outcome }}" = "failure" ]; then
            FAILED_STEPS="$FAILED_STEPS build-project"
          fi
          if [ "${{ steps.run-lint.outcome }}" = "failure" ]; then
            FAILED_STEPS="$FAILED_STEPS run-lint"
          fi
          if [ "${{ steps.run-tests.outcome }}" = "failure" ]; then
            FAILED_STEPS="$FAILED_STEPS run-tests"
          fi
          if [ "${{ steps.changesets-check.outcome }}" = "failure" ]; then
            FAILED_STEPS="$FAILED_STEPS changesets-check"
          fi
          if [ "${{ steps.npm-auth.outcome }}" = "failure" ]; then
            FAILED_STEPS="$FAILED_STEPS npm-auth"
          fi
          if [ "${{ steps.changesets.outcome }}" = "failure" ]; then
            FAILED_STEPS="$FAILED_STEPS changesets"
          fi
          if [ "${{ steps.create-tags.outcome }}" = "failure" ]; then
            FAILED_STEPS="$FAILED_STEPS create-tags"
          fi
          if [ "${{ steps.create-release.outcome }}" = "failure" ]; then
            FAILED_STEPS="$FAILED_STEPS create-release"
          fi
          
          echo "üö® Failed steps: $FAILED_STEPS"
          echo ""
          
          # Áí∞Â¢ÉÊÉÖÂ†±„ÅÆË©≥Á¥∞„É≠„Ç∞
          echo "üñ•Ô∏è Environment information:"
          echo "  - Runner OS: ${{ runner.os }}"
          echo "  - Runner architecture: ${{ runner.arch }}"
          echo "  - GitHub event: ${{ github.event_name }}"
          echo "  - Repository: ${{ github.repository }}"
          echo "  - Workflow: ${{ github.workflow }}"
          echo "  - Job: ${{ github.job }}"
          echo "  - Run ID: ${{ github.run_id }}"
          echo "  - Run number: ${{ github.run_number }}"
          echo "  - Run attempt: ${{ github.run_attempt }}"
          echo ""
          
          # ‰æùÂ≠òÈñ¢‰øÇ„Ç§„É≥„Çπ„Éà„Éº„É´Â§±Êïó„ÅÆË©≥Á¥∞ÂàÜÊûê
          if [ "${{ steps.install-deps.outcome }}" = "failure" ]; then
            echo "üîç DEPENDENCY INSTALLATION FAILURE ANALYSIS:"
            echo "‚îú‚îÄ Failure type: Critical - Blocks all subsequent steps"
            echo "‚îú‚îÄ Impact: High - Cannot proceed with build, test, or publish"
            echo "‚îú‚îÄ Common causes:"
            echo "‚îÇ  ‚Ä¢ pnpm-lock.yaml is outdated or corrupted"
            echo "‚îÇ  ‚Ä¢ package.json contains invalid dependency specifications"
            echo "‚îÇ  ‚Ä¢ Network connectivity issues to npm registry"
            echo "‚îÇ  ‚Ä¢ Registry authentication problems"
            echo "‚îÇ  ‚Ä¢ Disk space or memory limitations"
            echo "‚îÇ  ‚Ä¢ Node.js version incompatibility"
            echo "‚îÇ"
            echo "‚îú‚îÄ Immediate troubleshooting steps:"
            echo "‚îÇ  1. üîß Local reproduction:"
            echo "‚îÇ     cd $(pwd)"
            echo "‚îÇ     rm -rf node_modules pnpm-lock.yaml"
            echo "‚îÇ     pnpm install"
            echo "‚îÇ"
            echo "‚îÇ  2. üîç Dependency analysis:"
            echo "‚îÇ     pnpm audit"
            echo "‚îÇ     pnpm outdated"
            echo "‚îÇ"
            echo "‚îÇ  3. üßπ Cache cleanup:"
            echo "‚îÇ     pnpm store prune"
            echo "‚îÇ     pnpm install --frozen-lockfile"
            echo "‚îÇ"
            echo "‚îú‚îÄ Advanced troubleshooting:"
            echo "‚îÇ  ‚Ä¢ Check npm registry status: https://status.npmjs.org/"
            echo "‚îÇ  ‚Ä¢ Verify Node.js version compatibility"
            echo "‚îÇ  ‚Ä¢ Review package.json for syntax errors"
            echo "‚îÇ  ‚Ä¢ Check for conflicting peer dependencies"
            echo "‚îÇ  ‚Ä¢ Validate pnpm workspace configuration"
            echo "‚îÇ"
            echo "‚îî‚îÄ Manual resolution required before retry"
            echo ""
          fi
          
          # „Éì„É´„ÉâÂ§±Êïó„ÅÆË©≥Á¥∞ÂàÜÊûê
          if [ "${{ steps.build-project.outcome }}" = "failure" ]; then
            echo "üîç BUILD PROCESS FAILURE ANALYSIS:"
            echo "‚îú‚îÄ Failure type: Critical - Code compilation/build errors"
            echo "‚îú‚îÄ Impact: High - Cannot proceed with testing or publishing"
            echo "‚îú‚îÄ Common causes:"
            echo "‚îÇ  ‚Ä¢ TypeScript compilation errors"
            echo "‚îÇ  ‚Ä¢ Missing or incorrect type definitions"
            echo "‚îÇ  ‚Ä¢ Import/export statement issues"
            echo "‚îÇ  ‚Ä¢ Configuration file problems (tsconfig.json)"
            echo "‚îÇ  ‚Ä¢ Source code syntax errors"
            echo "‚îÇ  ‚Ä¢ Missing build dependencies"
            echo "‚îÇ"
            echo "‚îú‚îÄ Immediate troubleshooting steps:"
            echo "‚îÇ  1. üîß Local build reproduction:"
            echo "‚îÇ     pnpm specment:build"
            echo "‚îÇ     # Review all compilation errors"
            echo "‚îÇ"
            echo "‚îÇ  2. üîç TypeScript diagnostics:"
            echo "‚îÇ     npx tsc --noEmit --listFiles"
            echo "‚îÇ     npx tsc --showConfig"
            echo "‚îÇ"
            echo "‚îÇ  3. üßπ Clean build:"
            echo "‚îÇ     rm -rf dist/ build/ .tsbuildinfo"
            echo "‚îÇ     pnpm specment:build"
            echo "‚îÇ"
            echo "‚îú‚îÄ Advanced troubleshooting:"
            echo "‚îÇ  ‚Ä¢ Validate tsconfig.json syntax and paths"
            echo "‚îÇ  ‚Ä¢ Check for circular dependencies"
            echo "‚îÇ  ‚Ä¢ Verify all imports resolve correctly"
            echo "‚îÇ  ‚Ä¢ Review build script configuration"
            echo "‚îÇ  ‚Ä¢ Check for missing @types/* packages"
            echo "‚îÇ"
            echo "‚îú‚îÄ Code quality checks:"
            echo "‚îÇ  ‚Ä¢ Run linter: pnpm lint"
            echo "‚îÇ  ‚Ä¢ Check formatting: pnpm format:check"
            echo "‚îÇ  ‚Ä¢ Validate imports: pnpm check-imports"
            echo "‚îÇ"
            echo "‚îî‚îÄ Fix compilation errors before retry"
            echo ""
          fi
          
          # LintÂ§±Êïó„ÅÆË©≥Á¥∞ÂàÜÊûê
          if [ "${{ steps.run-lint.outcome }}" = "failure" ]; then
            echo "üîç LINTING FAILURE ANALYSIS:"
            echo "‚îú‚îÄ Failure type: Code quality - Style and best practice violations"
            echo "‚îú‚îÄ Impact: Medium - Blocks publication due to quality standards"
            echo "‚îú‚îÄ Common causes:"
            echo "‚îÇ  ‚Ä¢ Code style violations (formatting, spacing)"
            echo "‚îÇ  ‚Ä¢ ESLint rule violations"
            echo "‚îÇ  ‚Ä¢ Import/export ordering issues"
            echo "‚îÇ  ‚Ä¢ Unused variables or imports"
            echo "‚îÇ  ‚Ä¢ Missing or incorrect JSDoc comments"
            echo "‚îÇ  ‚Ä¢ Accessibility violations"
            echo "‚îÇ"
            echo "‚îú‚îÄ Immediate troubleshooting steps:"
            echo "‚îÇ  1. üîß Local linting check:"
            echo "‚îÇ     pnpm lint"
            echo "‚îÇ     # Review all linting errors and warnings"
            echo "‚îÇ"
            echo "‚îÇ  2. üîß Auto-fix available issues:"
            echo "‚îÇ     pnpm lint:fix"
            echo "‚îÇ     # Automatically fixes formatting and simple issues"
            echo "‚îÇ"
            echo "‚îÇ  3. üîç Detailed error analysis:"
            echo "‚îÇ     pnpm lint --format=detailed"
            echo "‚îÇ     # Shows detailed error descriptions and fix suggestions"
            echo "‚îÇ"
            echo "‚îú‚îÄ Advanced troubleshooting:"
            echo "‚îÇ  ‚Ä¢ Check .eslintrc configuration"
            echo "‚îÇ  ‚Ä¢ Verify .eslintignore patterns"
            echo "‚îÇ  ‚Ä¢ Review custom linting rules"
            echo "‚îÇ  ‚Ä¢ Check for conflicting formatter configurations"
            echo "‚îÇ  ‚Ä¢ Validate import paths and dependencies"
            echo "‚îÇ"
            echo "‚îú‚îÄ Quality improvement steps:"
            echo "‚îÇ  ‚Ä¢ Run formatter: pnpm format"
            echo "‚îÇ  ‚Ä¢ Check type safety: pnpm type-check"
            echo "‚îÇ  ‚Ä¢ Review code complexity: pnpm complexity-check"
            echo "‚îÇ"
            echo "‚îî‚îÄ Fix all linting issues before retry"
            echo ""
          fi
          
          # „ÉÜ„Çπ„ÉàÂ§±Êïó„ÅÆË©≥Á¥∞ÂàÜÊûê
          if [ "${{ steps.run-tests.outcome }}" = "failure" ]; then
            echo "üîç TEST SUITE FAILURE ANALYSIS:"
            echo "‚îú‚îÄ Failure type: Critical - Code functionality or regression issues"
            echo "‚îú‚îÄ Impact: High - Cannot guarantee code quality for publication"
            echo "‚îú‚îÄ Common causes:"
            echo "‚îÇ  ‚Ä¢ Unit test failures (logic errors)"
            echo "‚îÇ  ‚Ä¢ Integration test failures (component interaction issues)"
            echo "‚îÇ  ‚Ä¢ Test environment configuration problems"
            echo "‚îÇ  ‚Ä¢ Missing test dependencies or mocks"
            echo "‚îÇ  ‚Ä¢ Timing issues in async tests"
            echo "‚îÇ  ‚Ä¢ Test data or fixture problems"
            echo "‚îÇ"
            echo "‚îú‚îÄ Immediate troubleshooting steps:"
            echo "‚îÇ  1. üîß Local test reproduction:"
            echo "‚îÇ     pnpm --filter @plenarc/specment test"
            echo "‚îÇ     # Run all tests to identify failures"
            echo "‚îÇ"
            echo "‚îÇ  2. üîç Detailed test output:"
            echo "‚îÇ     pnpm --filter @plenarc/specment test --verbose"
            echo "‚îÇ     # Get detailed test execution information"
            echo "‚îÇ"
            echo "‚îÇ  3. üéØ Run specific failing tests:"
            echo "‚îÇ     pnpm --filter @plenarc/specment test --grep \"test-name\""
            echo "‚îÇ     # Focus on specific failing test cases"
            echo "‚îÇ"
            echo "‚îú‚îÄ Advanced troubleshooting:"
            echo "‚îÇ  ‚Ä¢ Check test configuration (vitest.config.ts)"
            echo "‚îÇ  ‚Ä¢ Verify test environment setup"
            echo "‚îÇ  ‚Ä¢ Review mock configurations and data"
            echo "‚îÇ  ‚Ä¢ Check for test isolation issues"
            echo "‚îÇ  ‚Ä¢ Validate async test handling"
            echo "‚îÇ"
            echo "‚îú‚îÄ Test debugging strategies:"
            echo "‚îÇ  ‚Ä¢ Run tests in watch mode: pnpm test --watch"
            echo "‚îÇ  ‚Ä¢ Generate coverage report: pnpm test --coverage"
            echo "‚îÇ  ‚Ä¢ Debug specific tests: pnpm test --inspect-brk"
            echo "‚îÇ  ‚Ä¢ Check test performance: pnpm test --reporter=verbose"
            echo "‚îÇ"
            echo "‚îú‚îÄ Quality assurance:"
            echo "‚îÇ  ‚Ä¢ Ensure test coverage meets requirements"
            echo "‚îÇ  ‚Ä¢ Verify all edge cases are tested"
            echo "‚îÇ  ‚Ä¢ Check for flaky or unstable tests"
            echo "‚îÇ  ‚Ä¢ Review test maintainability"
            echo "‚îÇ"
            echo "‚îî‚îÄ Fix all failing tests before retry"
            echo ""
          fi
          
          # ChangesetsÊ§úË®ºÂ§±Êïó„ÅÆË©≥Á¥∞ÂàÜÊûê
          if [ "${{ steps.changesets-check.outputs.validation-error }}" != "" ]; then
            echo "üîç CHANGESETS VALIDATION FAILURE ANALYSIS:"
            echo "‚îú‚îÄ Failure type: Configuration - Release management setup issues"
            echo "‚îú‚îÄ Impact: Medium - Prevents automated versioning and publishing"
            echo "‚îú‚îÄ Validation error: ${{ steps.changesets-check.outputs.validation-error }}"
            echo "‚îÇ"
            
            case "${{ steps.changesets-check.outputs.validation-error }}" in
              "missing-directory")
                echo "‚îú‚îÄ Specific issue: .changeset directory is missing"
                echo "‚îú‚îÄ Root cause: Changesets not initialized in repository"
                echo "‚îú‚îÄ Resolution steps:"
                echo "‚îÇ  1. üîß Initialize changesets:"
                echo "‚îÇ     pnpm changeset init"
                echo "‚îÇ  2. üìù Review generated configuration:"
                echo "‚îÇ     cat .changeset/config.json"
                echo "‚îÇ  3. üîß Customize settings if needed:"
                echo "‚îÇ     # Edit .changeset/config.json"
                echo "‚îÇ  4. üì¶ Commit the changeset directory:"
                echo "‚îÇ     git add .changeset/"
                echo "‚îÇ     git commit -m \"chore: initialize changesets\""
                echo "‚îÇ"
                echo "‚îú‚îÄ Verification:"
                echo "‚îÇ  ‚Ä¢ Ensure .changeset/config.json exists"
                echo "‚îÇ  ‚Ä¢ Verify .changeset/README.md is present"
                echo "‚îÇ  ‚Ä¢ Check configuration matches project needs"
                ;;
              "missing-config")
                echo "‚îú‚îÄ Specific issue: .changeset/config.json is missing"
                echo "‚îú‚îÄ Root cause: Incomplete changesets initialization"
                echo "‚îú‚îÄ Resolution steps:"
                echo "‚îÇ  1. üîß Reinitialize changesets:"
                echo "‚îÇ     rm -rf .changeset"
                echo "‚îÇ     pnpm changeset init"
                echo "‚îÇ  2. üìù Verify configuration file:"
                echo "‚îÇ     ls -la .changeset/"
                echo "‚îÇ     cat .changeset/config.json"
                echo "‚îÇ  3. üì¶ Commit the configuration:"
                echo "‚îÇ     git add .changeset/config.json"
                echo "‚îÇ     git commit -m \"chore: add changesets configuration\""
                echo "‚îÇ"
                echo "‚îú‚îÄ Verification:"
                echo "‚îÇ  ‚Ä¢ Confirm config.json has valid JSON structure"
                echo "‚îÇ  ‚Ä¢ Check all required fields are present"
                echo "‚îÇ  ‚Ä¢ Validate baseBranch setting matches repository"
                ;;
              "invalid-config-json")
                echo "‚îú‚îÄ Specific issue: .changeset/config.json contains invalid JSON"
                echo "‚îú‚îÄ Root cause: JSON syntax errors in configuration file"
                echo "‚îú‚îÄ Resolution steps:"
                echo "‚îÇ  1. üîç Validate JSON syntax:"
                echo "‚îÇ     cat .changeset/config.json | jq ."
                echo "‚îÇ     # Or use online JSON validator"
                echo "‚îÇ  2. üîß Fix JSON formatting errors:"
                echo "‚îÇ     # Common issues: trailing commas, unquoted keys, missing brackets"
                echo "‚îÇ  3. üìù Verify configuration structure:"
                echo "‚îÇ     # Ensure all required fields are present and correctly formatted"
                echo "‚îÇ  4. üß™ Test configuration:"
                echo "‚îÇ     pnpm changeset status"
                echo "‚îÇ"
                echo "‚îú‚îÄ Common JSON errors:"
                echo "‚îÇ  ‚Ä¢ Trailing commas in objects/arrays"
                echo "‚îÇ  ‚Ä¢ Unquoted property names"
                echo "‚îÇ  ‚Ä¢ Missing closing brackets/braces"
                echo "‚îÇ  ‚Ä¢ Invalid escape sequences"
                ;;
              "invalid-changeset-files")
                echo "‚îú‚îÄ Specific issue: One or more changeset files are invalid"
                echo "‚îú‚îÄ Root cause: Malformed changeset file format"
                echo "‚îú‚îÄ Resolution steps:"
                echo "‚îÇ  1. üîç Identify invalid files:"
                echo "‚îÇ     find .changeset -name \"*.md\" -not -name \"README.md\" -exec echo \"Checking: {}\" \\;"
                echo "‚îÇ  2. üîß Validate file format:"
                echo "‚îÇ     # Each file should start with --- (frontmatter)"
                echo "‚îÇ     # Followed by package changes"
                echo "‚îÇ     # Then --- to close frontmatter"
                echo "‚îÇ     # Finally the change description"
                echo "‚îÇ  3. üóëÔ∏è Remove invalid files:"
                echo "‚îÇ     # Delete corrupted changeset files"
                echo "‚îÇ  4. üìù Recreate changesets:"
                echo "‚îÇ     pnpm changeset"
                echo "‚îÇ     # Follow prompts to create properly formatted changesets"
                echo "‚îÇ"
                echo "‚îú‚îÄ Valid changeset format:"
                echo "‚îÇ  ---"
                echo "‚îÇ  \"@plenarc/specment\": patch"
                echo "‚îÇ  ---"
                echo "‚îÇ  "
                echo "‚îÇ  Description of the change"
                ;;
              *)
                echo "‚îú‚îÄ Specific issue: Unknown validation error"
                echo "‚îú‚îÄ Root cause: Unexpected changesets configuration problem"
                echo "‚îú‚îÄ Resolution steps:"
                echo "‚îÇ  1. üîç Check detailed validation logs above"
                echo "‚îÇ  2. üîß Verify changesets installation:"
                echo "‚îÇ     pnpm list @changesets/cli"
                echo "‚îÇ  3. üßπ Clean and reinitialize:"
                echo "‚îÇ     rm -rf .changeset"
                echo "‚îÇ     pnpm changeset init"
                echo "‚îÇ  4. üìö Consult changesets documentation:"
                echo "‚îÇ     https://github.com/changesets/changesets"
                ;;
            esac
            
            echo "‚îÇ"
            echo "‚îú‚îÄ Post-resolution verification:"
            echo "‚îÇ  1. Test changeset status: pnpm changeset status"
            echo "‚îÇ  2. Validate configuration: cat .changeset/config.json | jq ."
            echo "‚îÇ  3. Create test changeset: pnpm changeset"
            echo "‚îÇ  4. Verify workflow compatibility"
            echo "‚îÇ"
            echo "‚îî‚îÄ Changesets documentation: https://github.com/changesets/changesets/blob/main/docs/intro-to-using-changesets.md"
            echo ""
          fi
          
          # npmË™çË®ºÂ§±Êïó„ÅÆË©≥Á¥∞ÂàÜÊûê
          if [ "${{ steps.npm-auth.outcome }}" = "failure" ]; then
            echo "üîç NPM AUTHENTICATION FAILURE ANALYSIS:"
            echo "‚îú‚îÄ Failure type: Critical - Cannot publish without valid authentication"
            echo "‚îú‚îÄ Impact: High - Blocks all npm registry operations"
            echo "‚îú‚îÄ Authentication error: ${{ steps.npm-auth.outputs.auth-error }}"
            echo "‚îÇ"
            
            case "${{ steps.npm-auth.outputs.auth-error }}" in
              "missing-token")
                echo "‚îú‚îÄ Specific issue: NPM_TOKEN is not configured in GitHub Secrets"
                echo "‚îú‚îÄ Root cause: Missing or incorrectly named secret"
                echo "‚îú‚îÄ Resolution steps:"
                echo "‚îÇ  1. üîß Generate npm access token:"
                echo "‚îÇ     ‚Ä¢ Go to https://www.npmjs.com/settings/tokens"
                echo "‚îÇ     ‚Ä¢ Click 'Generate New Token'"
                echo "‚îÇ     ‚Ä¢ Select 'Automation' token type"
                echo "‚îÇ     ‚Ä¢ Copy the generated token (starts with 'npm_')"
                echo "‚îÇ  2. üîê Add token to GitHub Secrets:"
                echo "‚îÇ     ‚Ä¢ Go to repository Settings > Secrets and variables > Actions"
                echo "‚îÇ     ‚Ä¢ Click 'New repository secret'"
                echo "‚îÇ     ‚Ä¢ Name: NPM_TOKEN"
                echo "‚îÇ     ‚Ä¢ Value: [paste your npm token]"
                echo "‚îÇ  3. ‚úÖ Verify secret configuration:"
                echo "‚îÇ     ‚Ä¢ Ensure secret name is exactly 'NPM_TOKEN'"
                echo "‚îÇ     ‚Ä¢ Confirm token value is complete and correct"
                echo "‚îÇ"
                echo "‚îú‚îÄ Security considerations:"
                echo "‚îÇ  ‚Ä¢ Use 'Automation' token type for CI/CD"
                echo "‚îÇ  ‚Ä¢ Set appropriate token expiration"
                echo "‚îÇ  ‚Ä¢ Limit token scope to necessary packages"
                echo "‚îÇ  ‚Ä¢ Regularly rotate tokens for security"
                ;;
              "npmrc-creation-failed")
                echo "‚îú‚îÄ Specific issue: Failed to create .npmrc configuration file"
                echo "‚îú‚îÄ Root cause: File system permission or environment issues"
                echo "‚îú‚îÄ Resolution steps:"
                echo "‚îÇ  1. üîç Check runner environment:"
                echo "‚îÇ     ‚Ä¢ Verify WSL setup is working correctly"
                echo "‚îÇ     ‚Ä¢ Check file system permissions"
                echo "‚îÇ     ‚Ä¢ Ensure home directory is accessible"
                echo "‚îÇ  2. üîß Debug file creation:"
                echo "‚îÇ     ‚Ä¢ Check if ~/.npmrc can be created manually"
                echo "‚îÇ     ‚Ä¢ Verify write permissions to home directory"
                echo "‚îÇ     ‚Ä¢ Test with alternative .npmrc locations"
                echo "‚îÇ  3. üßπ Environment cleanup:"
                echo "‚îÇ     ‚Ä¢ Clear any existing .npmrc files"
                echo "‚îÇ     ‚Ä¢ Reset npm configuration"
                echo "‚îÇ     ‚Ä¢ Retry authentication setup"
                echo "‚îÇ"
                echo "‚îú‚îÄ Alternative approaches:"
                echo "‚îÇ  ‚Ä¢ Use npm config set commands instead of .npmrc file"
                echo "‚îÇ  ‚Ä¢ Set authentication via environment variables"
                echo "‚îÇ  ‚Ä¢ Use different npm configuration methods"
                ;;
              "auth-test-failed")
                echo "‚îú‚îÄ Specific issue: npm authentication test failed"
                echo "‚îú‚îÄ Root cause: Invalid, expired, or insufficient token permissions"
                echo "‚îú‚îÄ Resolution steps:"
                echo "‚îÇ  1. üîç Verify token validity:"
                echo "‚îÇ     ‚Ä¢ Check token format (should start with 'npm_')"
                echo "‚îÇ     ‚Ä¢ Ensure token hasn't expired"
                echo "‚îÇ     ‚Ä¢ Verify token wasn't revoked"
                echo "‚îÇ  2. üîê Check token permissions:"
                echo "‚îÇ     ‚Ä¢ Ensure token has 'publish' scope"
                echo "‚îÇ     ‚Ä¢ Verify access to target packages"
                echo "‚îÇ     ‚Ä¢ Check organization permissions if applicable"
                echo "‚îÇ  3. üîß Generate new token:"
                echo "‚îÇ     ‚Ä¢ Go to https://www.npmjs.com/settings/tokens"
                echo "‚îÇ     ‚Ä¢ Revoke old token if compromised"
                echo "‚îÇ     ‚Ä¢ Create new 'Automation' token"
                echo "‚îÇ     ‚Ä¢ Update GitHub Secret with new token"
                echo "‚îÇ  4. üß™ Test token locally:"
                echo "‚îÇ     ‚Ä¢ Set NPM_TOKEN environment variable"
                echo "‚îÇ     ‚Ä¢ Run 'npm whoami' to test authentication"
                echo "‚îÇ     ‚Ä¢ Verify package access with 'npm access list packages'"
                echo "‚îÇ"
                echo "‚îú‚îÄ Common token issues:"
                echo "‚îÇ  ‚Ä¢ Token expired (check expiration date)"
                echo "‚îÇ  ‚Ä¢ Insufficient permissions (needs publish scope)"
                echo "‚îÇ  ‚Ä¢ Token revoked or deleted"
                echo "‚îÇ  ‚Ä¢ Wrong token type (use 'Automation' not 'Publish')"
                echo "‚îÇ  ‚Ä¢ Network issues preventing authentication"
                echo "‚îÇ"
                echo "‚îú‚îÄ Token troubleshooting:"
                echo "‚îÇ  ‚Ä¢ Verify npm registry connectivity"
                echo "‚îÇ  ‚Ä¢ Check for rate limiting"
                echo "‚îÇ  ‚Ä¢ Test with different network connection"
                echo "‚îÇ  ‚Ä¢ Validate token format and completeness"
                ;;
              *)
                echo "‚îú‚îÄ Specific issue: Unknown authentication error"
                echo "‚îú‚îÄ Root cause: Unexpected npm authentication problem"
                echo "‚îú‚îÄ Resolution steps:"
                echo "‚îÇ  1. üîç Review detailed authentication logs above"
                echo "‚îÇ  2. üîß Verify npm configuration:"
                echo "‚îÇ     npm config list"
                echo "‚îÇ     npm config get registry"
                echo "‚îÇ  3. üß™ Test authentication manually:"
                echo "‚îÇ     npm whoami"
                echo "‚îÇ     npm ping"
                echo "‚îÇ  4. üßπ Reset npm configuration:"
                echo "‚îÇ     npm config delete //registry.npmjs.org/:_authToken"
                echo "‚îÇ     # Then reconfigure authentication"
                echo "‚îÇ"
                echo "‚îú‚îÄ Advanced troubleshooting:"
                echo "‚îÇ  ‚Ä¢ Check npm registry status: https://status.npmjs.org/"
                echo "‚îÇ  ‚Ä¢ Verify network connectivity to registry"
                echo "‚îÇ  ‚Ä¢ Test with different npm registry mirrors"
                echo "‚îÇ  ‚Ä¢ Check for proxy or firewall issues"
                ;;
            esac
            
            echo "‚îÇ"
            echo "‚îú‚îÄ Manual release fallback:"
            echo "‚îÇ  1. üìù Document the failure for manual processing"
            echo "‚îÇ  2. üîß Follow manual release process in RELEASE_PROCESS.md"
            echo "‚îÇ  3. üß™ Test authentication locally before manual release"
            echo "‚îÇ  4. üì¶ Perform manual npm publish after fixing authentication"
            echo "‚îÇ"
            echo "‚îú‚îÄ Prevention measures:"
            echo "‚îÇ  ‚Ä¢ Set up token expiration monitoring"
            echo "‚îÇ  ‚Ä¢ Implement token rotation schedule"
            echo "‚îÇ  ‚Ä¢ Create backup authentication methods"
            echo "‚îÇ  ‚Ä¢ Document token management procedures"
            echo "‚îÇ"
            echo "‚îî‚îÄ Resources:"
            echo "   ‚Ä¢ Token management: https://docs.npmjs.com/creating-and-viewing-access-tokens"
            echo "   ‚Ä¢ npm authentication: https://docs.npmjs.com/cli/v8/using-npm/registry"
            echo "   ‚Ä¢ Manual release guide: RELEASE_PROCESS.md"
            echo ""
          fi
          
          # „Éê„Éº„Ç∏„Éß„É≥Êõ¥Êñ∞„Å®npmÂÖ¨ÈñãÂá¶ÁêÜÂ§±Êïó„ÅÆË©≥Á¥∞ÂàÜÊûê
          if [ "${{ steps.changesets.outcome }}" = "failure" ]; then
            echo "üîç VERSION UPDATE AND NPM PUBLICATION FAILURE ANALYSIS:"
            echo "‚îú‚îÄ Failure type: Critical - Release process failure"
            echo "‚îú‚îÄ Impact: High - Cannot complete automated release"
            echo "‚îú‚îÄ Process stage: Version management and package publication"
            echo "‚îÇ"
            
            # „Éê„Éº„Ç∏„Éß„É≥Êõ¥Êñ∞Â§±Êïó„ÅÆË©≥Á¥∞ÂàÜÊûê
            if [ "${{ steps.changesets.outputs.version-changed }}" = "false" ] || [ "${{ steps.changesets.outputs.version-committed }}" = "false" ]; then
              echo "‚îú‚îÄ VERSION UPDATE FAILURE:"
              echo "‚îÇ  ‚îú‚îÄ Issue: Changeset version processing failed"
              echo "‚îÇ  ‚îú‚îÄ Status indicators:"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Version changed: ${{ steps.changesets.outputs.version-changed }}"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Version committed: ${{ steps.changesets.outputs.version-committed }}"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Current version: ${{ steps.changesets.outputs.current-version }}"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Target version: ${{ steps.changesets.outputs.new-version }}"
              echo "‚îÇ  ‚îÇ"
              echo "‚îÇ  ‚îú‚îÄ Common causes:"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Malformed changeset files"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Invalid .changeset/config.json configuration"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Git working directory not clean"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Conflicting package.json modifications"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Insufficient Git permissions"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Changeset CLI version incompatibility"
              echo "‚îÇ  ‚îÇ"
              echo "‚îÇ  ‚îú‚îÄ Resolution steps:"
              echo "‚îÇ  ‚îÇ  1. üîç Local reproduction:"
              echo "‚îÇ  ‚îÇ     git status"
              echo "‚îÇ  ‚îÇ     pnpm changeset version"
              echo "‚îÇ  ‚îÇ     # Review any error messages"
              echo "‚îÇ  ‚îÇ  2. üßπ Clean working directory:"
              echo "‚îÇ  ‚îÇ     git stash"
              echo "‚îÇ  ‚îÇ     git clean -fd"
              echo "‚îÇ  ‚îÇ     pnpm changeset version"
              echo "‚îÇ  ‚îÇ  3. üîß Validate changeset files:"
              echo "‚îÇ  ‚îÇ     find .changeset -name \"*.md\" -not -name \"README.md\" -exec head -5 {} \\;"
              echo "‚îÇ  ‚îÇ  4. üß™ Test configuration:"
              echo "‚îÇ  ‚îÇ     pnpm changeset status"
              echo "‚îÇ  ‚îÇ     cat .changeset/config.json | jq ."
              echo "‚îÇ  ‚îÇ"
              echo "‚îÇ  ‚îî‚îÄ Advanced troubleshooting:"
              echo "‚îÇ     ‚Ä¢ Check changeset CLI version compatibility"
              echo "‚îÇ     ‚Ä¢ Verify package.json workspace configuration"
              echo "‚îÇ     ‚Ä¢ Review Git configuration and permissions"
              echo "‚îÇ     ‚Ä¢ Test with minimal changeset configuration"
              echo "‚îÇ"
            fi
            
            # npmÂÖ¨ÈñãÂ§±Êïó„ÅÆË©≥Á¥∞ÂàÜÊûê
            if [ "${{ steps.changesets.outputs.publish-success }}" = "false" ]; then
              echo "‚îú‚îÄ NPM PUBLICATION FAILURE:"
              echo "‚îÇ  ‚îú‚îÄ Issue: Package publication to npm registry failed"
              echo "‚îÇ  ‚îú‚îÄ Status indicators:"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Publish success: ${{ steps.changesets.outputs.publish-success }}"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Registry verified: ${{ steps.changesets.outputs.registry-verified }}"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Published package: ${{ steps.changesets.outputs.published-package }}"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Authentication status: ${{ steps.npm-auth.outputs.npm-auth-success }}"
              echo "‚îÇ  ‚îÇ"
              echo "‚îÇ  ‚îú‚îÄ Common causes:"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Network connectivity issues to npm registry"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Package name/version already exists"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Insufficient npm token permissions"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ npm registry rate limiting"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Package configuration errors"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Registry temporary unavailability"
              echo "‚îÇ  ‚îÇ"
              echo "‚îÇ  ‚îú‚îÄ Immediate troubleshooting:"
              echo "‚îÇ  ‚îÇ  1. üîç Check registry status:"
              echo "‚îÇ  ‚îÇ     curl -s https://registry.npmjs.org/ | jq ."
              echo "‚îÇ  ‚îÇ     # Visit https://status.npmjs.org/"
              echo "‚îÇ  ‚îÇ  2. üîß Verify package availability:"
              echo "‚îÇ  ‚îÇ     npm view ${{ steps.changesets.outputs.package-name }}@${{ steps.changesets.outputs.new-version }}"
              echo "‚îÇ  ‚îÇ  3. üß™ Test authentication:"
              echo "‚îÇ  ‚îÇ     npm whoami"
              echo "‚îÇ  ‚îÇ     npm access list packages"
              echo "‚îÇ  ‚îÇ  4. üîç Check package configuration:"
              echo "‚îÇ  ‚îÇ     cat packages/specment/package.json | jq '.name, .version, .publishConfig'"
              echo "‚îÇ  ‚îÇ"
              echo "‚îÇ  ‚îú‚îÄ Advanced troubleshooting:"
              echo "‚îÇ  ‚îÇ  1. üîß Manual publication test:"
              echo "‚îÇ  ‚îÇ     cd packages/specment"
              echo "‚îÇ  ‚îÇ     npm publish --dry-run"
              echo "‚îÇ  ‚îÇ     # Review what would be published"
              echo "‚îÇ  ‚îÇ  2. üîç Package content validation:"
              echo "‚îÇ  ‚îÇ     npm pack"
              echo "‚îÇ  ‚îÇ     tar -tzf *.tgz"
              echo "‚îÇ  ‚îÇ     # Verify package contents"
              echo "‚îÇ  ‚îÇ  3. üß™ Alternative publication methods:"
              echo "‚îÇ  ‚îÇ     pnpm publish --access public"
              echo "‚îÇ  ‚îÇ     # Try direct pnpm publish"
              echo "‚îÇ  ‚îÇ"
              echo "‚îÇ  ‚îî‚îÄ Publication retry strategies:"
              echo "‚îÇ     ‚Ä¢ Wait for registry availability"
              echo "‚îÇ     ‚Ä¢ Use different npm registry mirror"
              echo "‚îÇ     ‚Ä¢ Implement exponential backoff retry"
              echo "‚îÇ     ‚Ä¢ Split publication into smaller batches"
              echo "‚îÇ"
            fi
            
            # „É¨„Ç∏„Çπ„Éà„É™Ê§úË®ºÂ§±Êïó„ÅÆÂ†¥Âêà
            if [ "${{ steps.changesets.outputs.registry-verified }}" = "false" ]; then
              echo "‚îú‚îÄ REGISTRY VERIFICATION FAILURE:"
              echo "‚îÇ  ‚îú‚îÄ Issue: Published package not immediately visible on registry"
              echo "‚îÇ  ‚îú‚îÄ Likely causes:"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ npm registry propagation delay (normal)"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ CDN cache update lag"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Registry indexing delay"
              echo "‚îÇ  ‚îÇ  ‚Ä¢ Network connectivity issues during verification"
              echo "‚îÇ  ‚îÇ"
              echo "‚îÇ  ‚îú‚îÄ Resolution approach:"
              echo "‚îÇ  ‚îÇ  1. ‚è≥ Wait for propagation (2-5 minutes typical)"
              echo "‚îÇ  ‚îÇ  2. üîç Manual verification:"
              echo "‚îÇ  ‚îÇ     npm view ${{ steps.changesets.outputs.package-name }}@${{ steps.changesets.outputs.new-version }}"
              echo "‚îÇ  ‚îÇ  3. üåê Check multiple registry endpoints:"
              echo "‚îÇ  ‚îÇ     curl -s https://registry.npmjs.org/${{ steps.changesets.outputs.package-name }}"
              echo "‚îÇ  ‚îÇ  4. üì¶ Verify package installation:"
              echo "‚îÇ  ‚îÇ     npm install ${{ steps.changesets.outputs.package-name }}@${{ steps.changesets.outputs.new-version }}"
              echo "‚îÇ  ‚îÇ"
              echo "‚îÇ  ‚îî‚îÄ Note: This may not indicate actual publication failure"
              echo "‚îÇ"
            fi
            
            echo "‚îú‚îÄ COMPREHENSIVE RECOVERY PLAN:"
            echo "‚îÇ  1. üîç Assess current state:"
            echo "‚îÇ     ‚Ä¢ Check if version was updated in package.json"
            echo "‚îÇ     ‚Ä¢ Verify if package was actually published"
            echo "‚îÇ     ‚Ä¢ Review Git commit and tag status"
            echo "‚îÇ  2. üîß Determine recovery action:"
            echo "‚îÇ     ‚Ä¢ If version updated but not published: retry publication"
            echo "‚îÇ     ‚Ä¢ If neither updated: fix changesets and retry"
            echo "‚îÇ     ‚Ä¢ If published but not verified: wait and verify manually"
            echo "‚îÇ  3. üìù Manual release fallback:"
            echo "‚îÇ     ‚Ä¢ Follow RELEASE_PROCESS.md for manual steps"
            echo "‚îÇ     ‚Ä¢ Document the failure for process improvement"
            echo "‚îÇ     ‚Ä¢ Update team on release status"
            echo "‚îÇ"
            echo "‚îú‚îÄ PREVENTION MEASURES:"
            echo "‚îÇ  ‚Ä¢ Implement pre-publication validation checks"
            echo "‚îÇ  ‚Ä¢ Set up monitoring for npm registry status"
            echo "‚îÇ  ‚Ä¢ Create automated retry mechanisms"
            echo "‚îÇ  ‚Ä¢ Establish manual release procedures"
            echo "‚îÇ  ‚Ä¢ Regular testing of publication pipeline"
            echo "‚îÇ"
            echo "‚îî‚îÄ RESOURCES AND DOCUMENTATION:"
            echo "   ‚Ä¢ Manual release process: RELEASE_PROCESS.md"
            echo "   ‚Ä¢ Changeset workflow guide: CHANGESET_WORKFLOW.md"
            echo "   ‚Ä¢ npm registry status: https://status.npmjs.org/"
            echo "   ‚Ä¢ npm token management: https://docs.npmjs.com/creating-and-viewing-access-tokens"
            echo "   ‚Ä¢ Changesets documentation: https://github.com/changesets/changesets"
            echo ""
          fi
          
          # Git„Çø„Ç∞‰ΩúÊàêÂ§±Êïó„ÅÆË©≥Á¥∞ÂàÜÊûê
          if [ "${{ steps.create-tags.outcome }}" = "failure" ]; then
            echo "üîç GIT TAG CREATION FAILURE ANALYSIS:"
            echo "‚îú‚îÄ Failure type: Release metadata - Git tag creation issues"
            echo "‚îú‚îÄ Impact: Medium - Package published but missing version tag"
            echo "‚îú‚îÄ Status indicators:"
            echo "‚îÇ  ‚Ä¢ Tag created: ${{ steps.create-tags.outputs.tag-created }}"
            echo "‚îÇ  ‚Ä¢ Tag pushed: ${{ steps.create-tags.outputs.tag-pushed }}"
            echo "‚îÇ  ‚Ä¢ Tag name: ${{ steps.create-tags.outputs.tag-name }}"
            echo "‚îÇ  ‚Ä¢ Package version: ${{ steps.create-tags.outputs.package-version }}"
            echo "‚îÇ"
            echo "‚îú‚îÄ Common causes:"
            echo "‚îÇ  ‚Ä¢ Tag already exists with different commit"
            echo "‚îÇ  ‚Ä¢ Git configuration or permission issues"
            echo "‚îÇ  ‚Ä¢ Invalid package.json version information"
            echo "‚îÇ  ‚Ä¢ Git repository access problems"
            echo "‚îÇ  ‚Ä¢ Network connectivity issues"
            echo "‚îÇ  ‚Ä¢ GITHUB_TOKEN insufficient permissions"
            echo "‚îÇ"
            echo "‚îú‚îÄ Resolution steps:"
            echo "‚îÇ  1. üîç Check existing tags:"
            echo "‚îÇ     git tag -l | grep v${{ steps.create-tags.outputs.package-version }}"
            echo "‚îÇ     git ls-remote --tags origin"
            echo "‚îÇ  2. üîß Manual tag creation:"
            echo "‚îÇ     git tag -a v${{ steps.create-tags.outputs.package-version }} -m \"Release v${{ steps.create-tags.outputs.package-version }}\""
            echo "‚îÇ     git push origin v${{ steps.create-tags.outputs.package-version }}"
            echo "‚îÇ  3. üßπ Clean conflicting tags:"
            echo "‚îÇ     git tag -d v${{ steps.create-tags.outputs.package-version }}"
            echo "‚îÇ     git push origin --delete v${{ steps.create-tags.outputs.package-version }}"
            echo "‚îÇ     # Then recreate the tag"
            echo "‚îÇ  4. üîç Verify Git configuration:"
            echo "‚îÇ     git config --list | grep user"
            echo "‚îÇ     git remote -v"
            echo "‚îÇ"
            echo "‚îú‚îÄ Advanced troubleshooting:"
            echo "‚îÇ  ‚Ä¢ Check GITHUB_TOKEN permissions for repository"
            echo "‚îÇ  ‚Ä¢ Verify Git repository write access"
            echo "‚îÇ  ‚Ä¢ Test tag creation with different tag names"
            echo "‚îÇ  ‚Ä¢ Review Git hooks that might block tag creation"
            echo "‚îÇ"
            echo "‚îî‚îÄ Impact assessment:"
            echo "   ‚Ä¢ Package is published and functional"
            echo "   ‚Ä¢ Missing tag affects release tracking"
            echo "   ‚Ä¢ Manual tag creation recommended"
            echo ""
          fi
          
          # GitHub Release‰ΩúÊàêÂ§±Êïó„ÅÆË©≥Á¥∞ÂàÜÊûê
          if [ "${{ steps.create-release.outcome }}" = "failure" ] || [ "${{ steps.create-release.outputs.release-created }}" = "false" ]; then
            echo "üîç GITHUB RELEASE CREATION FAILURE ANALYSIS:"
            echo "‚îú‚îÄ Failure type: Release documentation - GitHub Release creation issues"
            echo "‚îú‚îÄ Impact: Low - Package published, tag may exist, missing release notes"
            echo "‚îú‚îÄ Status indicators:"
            echo "‚îÇ  ‚Ä¢ Release created: ${{ steps.create-release.outputs.release-created }}"
            echo "‚îÇ  ‚Ä¢ Release URL: ${{ steps.create-release.outputs.html_url }}"
            echo "‚îÇ  ‚Ä¢ Tag status: ${{ steps.create-tags.outputs.tag-created }}"
            echo "‚îÇ"
            echo "‚îú‚îÄ Common causes:"
            echo "‚îÇ  ‚Ä¢ GitHub API rate limiting"
            echo "‚îÇ  ‚Ä¢ GITHUB_TOKEN insufficient permissions"
            echo "‚îÇ  ‚Ä¢ Release with same tag already exists"
            echo "‚îÇ  ‚Ä¢ Network connectivity issues"
            echo "‚îÇ  ‚Ä¢ GitHub CLI authentication problems"
            echo "‚îÇ  ‚Ä¢ Release content formatting issues"
            echo "‚îÇ"
            echo "‚îú‚îÄ Resolution steps:"
            echo "‚îÇ  1. üîç Check existing releases:"
            echo "‚îÇ     gh release list"
            echo "‚îÇ     # Or visit https://github.com/${{ github.repository }}/releases"
            echo "‚îÇ  2. üîß Manual release creation:"
            echo "‚îÇ     gh release create v${{ steps.create-tags.outputs.package-version }} \\"
            echo "‚îÇ       --title \"Release v${{ steps.create-tags.outputs.package-version }}\" \\"
            echo "‚îÇ       --notes \"Automated release for v${{ steps.create-tags.outputs.package-version }}\""
            echo "‚îÇ  3. üåê Web interface creation:"
            echo "‚îÇ     ‚Ä¢ Go to https://github.com/${{ github.repository }}/releases"
            echo "‚îÇ     ‚Ä¢ Click 'Create a new release'"
            echo "‚îÇ     ‚Ä¢ Select tag: v${{ steps.create-tags.outputs.package-version }}"
            echo "‚îÇ     ‚Ä¢ Add title and release notes"
            echo "‚îÇ     ‚Ä¢ Click 'Publish release'"
            echo "‚îÇ  4. üîç Verify GITHUB_TOKEN permissions:"
            echo "‚îÇ     # Ensure token has 'contents: write' permission"
            echo "‚îÇ"
            echo "‚îú‚îÄ Release notes template:"
            echo "‚îÇ  Title: Release v${{ steps.create-tags.outputs.package-version }}"
            echo "‚îÇ  Notes:"
            echo "‚îÇ    üéâ New release of ${{ steps.create-tags.outputs.package-name }}"
            echo "‚îÇ    üì¶ Version: v${{ steps.create-tags.outputs.package-version }}"
            echo "‚îÇ    üì• Install: npm install ${{ steps.create-tags.outputs.package-name }}@${{ steps.create-tags.outputs.package-version }}"
            echo "‚îÇ    üìö View on npm: https://www.npmjs.com/package/${{ steps.create-tags.outputs.package-name }}"
            echo "‚îÇ"
            echo "‚îî‚îÄ Impact assessment:"
            echo "   ‚Ä¢ Package is published and functional"
            echo "   ‚Ä¢ Git tag may exist for version tracking"
            echo "   ‚Ä¢ Missing release notes for user communication"
            echo ""
          fi
          
          echo "üîß COMPREHENSIVE MANUAL RELEASE GUIDE:"
          echo "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê"
          echo "‚îÇ                    MANUAL RELEASE CHECKLIST                     ‚îÇ"
          echo "‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§"
          echo "‚îÇ Step 1: Verify Current State                                   ‚îÇ"
          echo "‚îÇ  ‚ñ° Check if package was published: npm view ${{ steps.changesets.outputs.package-name }}@${{ steps.changesets.outputs.new-version }}"
          echo "‚îÇ  ‚ñ° Verify version in package.json matches expected"
          echo "‚îÇ  ‚ñ° Check if Git tag exists: git tag -l | grep v${{ steps.changesets.outputs.new-version }}"
          echo "‚îÇ  ‚ñ° Review workflow logs for partial completion"
          echo "‚îÇ                                                                 ‚îÇ"
          echo "‚îÇ Step 2: Complete Missing Steps                                 ‚îÇ"
          echo "‚îÇ  ‚ñ° If package not published:"
          echo "‚îÇ    ‚Ä¢ Fix authentication issues"
          echo "‚îÇ    ‚Ä¢ Run: pnpm changeset publish"
          echo "‚îÇ  ‚ñ° If Git tag missing:"
          echo "‚îÇ    ‚Ä¢ Create tag: git tag -a v${{ steps.changesets.outputs.new-version }} -m \"Release v${{ steps.changesets.outputs.new-version }}\""
          echo "‚îÇ    ‚Ä¢ Push tag: git push origin v${{ steps.changesets.outputs.new-version }}"
          echo "‚îÇ  ‚ñ° If GitHub Release missing:"
          echo "‚îÇ    ‚Ä¢ Use GitHub web interface or CLI"
          echo "‚îÇ    ‚Ä¢ Include release notes and installation instructions"
          echo "‚îÇ                                                                 ‚îÇ"
          echo "‚îÇ Step 3: Verification                                           ‚îÇ"
          echo "‚îÇ  ‚ñ° Confirm package is installable: npm install ${{ steps.changesets.outputs.package-name }}@${{ steps.changesets.outputs.new-version }}"
          echo "‚îÇ  ‚ñ° Verify tag is visible: git ls-remote --tags origin"
          echo "‚îÇ  ‚ñ° Check release page: https://github.com/${{ github.repository }}/releases"
          echo "‚îÇ  ‚ñ° Test package functionality"
          echo "‚îÇ                                                                 ‚îÇ"
          echo "‚îÇ Step 4: Communication                                          ‚îÇ"
          echo "‚îÇ  ‚ñ° Update team on release status"
          echo "‚îÇ  ‚ñ° Document any issues for process improvement"
          echo "‚îÇ  ‚ñ° Share release information with stakeholders"
          echo "‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò"
          echo ""
          
          echo "üìö DOCUMENTATION AND RESOURCES:"
          echo "‚îú‚îÄ Project documentation:"
          echo "‚îÇ  ‚Ä¢ Manual release process: RELEASE_PROCESS.md"
          echo "‚îÇ  ‚Ä¢ Changeset workflow guide: CHANGESET_WORKFLOW.md"
          echo "‚îÇ  ‚Ä¢ Contributing guidelines: CONTRIBUTING.md"
          echo "‚îú‚îÄ External resources:"
          echo "‚îÇ  ‚Ä¢ npm registry status: https://status.npmjs.org/"
          echo "‚îÇ  ‚Ä¢ GitHub status: https://www.githubstatus.com/"
          echo "‚îÇ  ‚Ä¢ npm token management: https://docs.npmjs.com/creating-and-viewing-access-tokens"
          echo "‚îÇ  ‚Ä¢ Changesets documentation: https://github.com/changesets/changesets"
          echo "‚îÇ  ‚Ä¢ GitHub CLI documentation: https://cli.github.com/manual/"
          echo "‚îî‚îÄ Support channels:"
          echo "   ‚Ä¢ Repository issues: https://github.com/${{ github.repository }}/issues"
          echo "   ‚Ä¢ Repository discussions: https://github.com/${{ github.repository }}/discussions"
          echo ""
          
          echo "üö® ESCALATION PROCEDURES:"
          echo "If the issue persists after following the troubleshooting steps:"
          echo "  1. üìã Document the complete failure scenario"
          echo "  2. üîç Gather all relevant logs and error messages"
          echo "  3. üß™ Attempt local reproduction of the issue"
          echo "  4. üîß Implement the specific fix for the root cause"
          echo "  5. üß™ Test the fix in a safe environment"
          echo "  6. üöÄ Push the fix to trigger a new workflow run"
          echo "  7. üìù Update documentation to prevent future occurrences"
          echo ""
          
          echo "‚ö° QUICK RECOVERY COMMANDS:"
          echo "# For immediate manual release (if package not published):"
          echo "pnpm changeset publish"
          echo ""
          echo "# For missing Git tag:"
          echo "git tag -a v${{ steps.changesets.outputs.new-version }} -m \"Release v${{ steps.changesets.outputs.new-version }}\""
          echo "git push origin v${{ steps.changesets.outputs.new-version }}"
          echo ""
          echo "# For missing GitHub Release:"
          echo "gh release create v${{ steps.changesets.outputs.new-version }} --title \"Release v${{ steps.changesets.outputs.new-version }}\" --generate-notes"
          echo ""
          
          echo "üéØ WORKFLOW COMPLETION STATUS: FAILED"
          echo "üìä Failure analysis completed at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
          echo "üîó Workflow run details: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"